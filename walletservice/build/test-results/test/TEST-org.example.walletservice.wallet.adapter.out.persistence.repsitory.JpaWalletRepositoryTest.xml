<?xml version="1.0" encoding="UTF-8"?>
<testsuite name="org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepositoryTest" tests="5" skipped="0" failures="0" errors="0" timestamp="2024-08-29T12:04:52" hostname="gangchanghwan-ui-MacBookPro.local" time="1.829">
  <properties/>
  <testcase name="repetition 1 of 5" classname="org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepositoryTest" time="1.074"/>
  <testcase name="repetition 2 of 5" classname="org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepositoryTest" time="0.234"/>
  <testcase name="repetition 3 of 5" classname="org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepositoryTest" time="0.153"/>
  <testcase name="repetition 4 of 5" classname="org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepositoryTest" time="0.141"/>
  <testcase name="repetition 5 of 5" classname="org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepositoryTest" time="0.215"/>
  <system-out><![CDATA[21:04:46.305 [Test worker] INFO org.springframework.test.context.support.AnnotationConfigContextLoaderUtils -- Could not detect default configuration classes for test class [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepositoryTest]: JpaWalletRepositoryTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
21:04:46.438 [Test worker] INFO org.springframework.boot.test.context.SpringBootTestContextBootstrapper -- Found @SpringBootConfiguration org.example.walletservice.WalletserviceApplication for test class org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepositoryTest

  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/
 :: Spring Boot ::                (v3.2.9)

2024-08-29T21:04:46.880+09:00  INFO 42267 --- [wallet-service] [    Test worker] o.e.w.w.a.o.p.r.JpaWalletRepositoryTest  : Starting JpaWalletRepositoryTest using Java 17.0.10 with PID 42267 (started by gangchanghwan in /Users/gangchanghwan/Documents/practice/payment-service/walletservice)
2024-08-29T21:04:46.881+09:00  INFO 42267 --- [wallet-service] [    Test worker] o.e.w.w.a.o.p.r.JpaWalletRepositoryTest  : No active profile set, falling back to 1 default profile: "default"
2024-08-29T21:04:47.607+09:00  INFO 42267 --- [wallet-service] [    Test worker] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2024-08-29T21:04:47.765+09:00  INFO 42267 --- [wallet-service] [    Test worker] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 150 ms. Found 3 JPA repository interfaces.
2024-08-29T21:04:47.911+09:00  INFO 42267 --- [wallet-service] [    Test worker] faultConfiguringBeanFactoryPostProcessor : No bean named 'errorChannel' has been explicitly defined. Therefore, a default PublishSubscribeChannel will be created.
2024-08-29T21:04:47.920+09:00  INFO 42267 --- [wallet-service] [    Test worker] faultConfiguringBeanFactoryPostProcessor : No bean named 'integrationHeaderChannelRegistry' has been explicitly defined. Therefore, a default DefaultHeaderChannelRegistry will be created.
2024-08-29T21:04:48.116+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.transaction.annotation.ProxyTransactionManagementConfiguration
2024-08-29T21:04:48.118+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.transaction.annotation.AnnotationTransactionAttributeSource
2024-08-29T21:04:48.125+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.transaction.interceptor.TransactionInterceptor
2024-08-29T21:04:48.128+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.transaction.interceptor.BeanFactoryTransactionAttributeSourceAdvisor
2024-08-29T21:04:48.141+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.data.web.config.ProjectingArgumentResolverRegistrar$ProjectingArgumentResolverBeanPostProcessor
2024-08-29T21:04:48.142+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.integration.config.IntegrationManagementConfiguration
2024-08-29T21:04:48.144+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.integration.config.IntegrationManagementConfigurer
2024-08-29T21:04:48.145+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.integration.config.MessagingAnnotationBeanPostProcessor
2024-08-29T21:04:48.147+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.integration.config.GatewayProxyInstantiationPostProcessor
2024-08-29T21:04:48.148+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.cloud.stream.config.BindingServiceConfiguration$1
2024-08-29T21:04:48.149+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.integration.config.GlobalChannelInterceptorProcessor
2024-08-29T21:04:48.152+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.integration.dsl.context.IntegrationFlowBeanPostProcessor
2024-08-29T21:04:48.153+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.integration.dsl.BaseIntegrationFlowDefinition$ReplyProducerCleaner
2024-08-29T21:04:48.157+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.sql.init.DataSourceInitializationConfiguration
2024-08-29T21:04:48.158+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.jdbc.DataSourceConfiguration$Hikari
2024-08-29T21:04:48.160+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.context.properties.BoundConfigurationProperties
2024-08-29T21:04:48.165+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.cloud.stream.config.BindingServiceConfiguration
2024-08-29T21:04:48.166+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.cloud.stream.binder.kafka.config.ExtendedBindingHandlerMappingsProviderConfiguration
2024-08-29T21:04:48.167+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.cloud.stream.binder.kafka.config.ExtendedBindingHandlerMappingsProviderConfiguration$$Lambda$1001/0x00000001265ebf18
2024-08-29T21:04:48.168+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.cloud.stream.config.BindingHandlerAdvise
2024-08-29T21:04:48.170+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.cloud.stream.config.SpelExpressionConverterConfiguration
2024-08-29T21:04:48.176+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.cloud.stream.config.SpelExpressionConverterConfiguration$SpelConverter
2024-08-29T21:04:48.187+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.jdbc.DataSourceProperties
2024-08-29T21:04:48.189+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration$PooledDataSourceConfiguration
2024-08-29T21:04:48.190+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.jdbc.PropertiesJdbcConnectionDetails
2024-08-29T21:04:48.210+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class com.zaxxer.hikari.HikariDataSource
2024-08-29T21:04:48.214+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.sql.init.SqlInitializationProperties
2024-08-29T21:04:48.226+09:00  INFO 42267 --- [wallet-service] [    Test worker] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2024-08-29T21:04:48.516+09:00  INFO 42267 --- [wallet-service] [    Test worker] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@44ddb518
2024-08-29T21:04:48.518+09:00  INFO 42267 --- [wallet-service] [    Test worker] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2024-08-29T21:04:48.533+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.sql.init.SqlDataSourceScriptDatabaseInitializer
2024-08-29T21:04:48.539+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.orm.jpa.JpaProperties
2024-08-29T21:04:48.542+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.orm.jpa.HibernateProperties
2024-08-29T21:04:48.544+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.jdbc.metadata.DataSourcePoolMetadataProvidersConfiguration$HikariPoolDataSourceMetadataProviderConfiguration
2024-08-29T21:04:48.545+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.jdbc.metadata.DataSourcePoolMetadataProvidersConfiguration$HikariPoolDataSourceMetadataProviderConfiguration$$Lambda$1099/0x00000001266cc828
2024-08-29T21:04:48.548+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.orm.jpa.HibernateJpaConfiguration
2024-08-29T21:04:48.562+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter
2024-08-29T21:04:48.566+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.orm.jpa.EntityManagerFactoryBuilder
2024-08-29T21:04:48.576+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.orm.jpa.persistenceunit.SimplePersistenceManagedTypes
2024-08-29T21:04:48.592+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] j.LocalContainerEntityManagerFactoryBean : Building JPA container EntityManagerFactory for persistence unit 'default'
2024-08-29T21:04:48.609+09:00  INFO 42267 --- [wallet-service] [    Test worker] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2024-08-29T21:04:48.682+09:00  INFO 42267 --- [wallet-service] [    Test worker] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.4.10.Final
2024-08-29T21:04:48.728+09:00  INFO 42267 --- [wallet-service] [    Test worker] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2024-08-29T21:04:49.003+09:00  INFO 42267 --- [wallet-service] [    Test worker] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2024-08-29T21:04:49.064+09:00  WARN 42267 --- [wallet-service] [    Test worker] org.hibernate.orm.deprecation            : HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2024-08-29T21:04:49.064+09:00  WARN 42267 --- [wallet-service] [    Test worker] org.hibernate.orm.deprecation            : HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2024-08-29T21:04:49.810+09:00  INFO 42267 --- [wallet-service] [    Test worker] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2024-08-29T21:04:49.861+09:00  INFO 42267 --- [wallet-service] [    Test worker] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2024-08-29T21:04:49.865+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean
2024-08-29T21:04:49.868+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.example.walletservice.WalletserviceApplication$$SpringCGLIB$$0
2024-08-29T21:04:49.889+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.data.repository.config.PropertiesBasedNamedQueriesFactoryBean
2024-08-29T21:04:49.890+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.data.repository.core.support.PropertiesBasedNamedQueries
2024-08-29T21:04:49.891+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.data.repository.core.support.RepositoryFragmentsFactoryBean
2024-08-29T21:04:49.898+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments
2024-08-29T21:04:49.901+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class jdk.proxy3.$Proxy132
2024-08-29T21:04:49.926+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class jdk.proxy3.$Proxy136
2024-08-29T21:04:49.944+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.data.jpa.repository.config.JpaMetamodelMappingContextFactoryBean
2024-08-29T21:04:49.950+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.data.jpa.mapping.JpaMetamodelMappingContext
2024-08-29T21:04:49.964+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] tor$SharedEntityManagerInvocationHandler : Creating new EntityManager for shared EntityManager invocation
2024-08-29T21:04:49.994+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] tor$SharedEntityManagerInvocationHandler : Creating new EntityManager for shared EntityManager invocation
2024-08-29T21:04:50.062+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] tor$SharedEntityManagerInvocationHandler : Creating new EntityManager for shared EntityManager invocation
2024-08-29T21:04:50.274+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] tor$SharedEntityManagerInvocationHandler : Creating new EntityManager for shared EntityManager invocation
2024-08-29T21:04:50.323+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.data.jpa.repository.support.JpaRepositoryFactoryBean
2024-08-29T21:04:50.326+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class jdk.proxy3.$Proxy141
2024-08-29T21:04:50.332+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.example.walletservice.wallet.adapter.out.persistence.entity.JpaWalletTransactionMapper
2024-08-29T21:04:50.336+09:00 TRACE 42267 --- [wallet-service] [    Test worker] t.a.AnnotationTransactionAttributeSource : Adding transactional method 'org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save' with attribute: PROPAGATION_REQUIRED,ISOLATION_DEFAULT
2024-08-29T21:04:50.352+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository$$SpringCGLIB$$0
2024-08-29T21:04:50.358+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] tor$SharedEntityManagerInvocationHandler : Creating new EntityManager for shared EntityManager invocation
2024-08-29T21:04:50.366+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] tor$SharedEntityManagerInvocationHandler : Creating new EntityManager for shared EntityManager invocation
2024-08-29T21:04:50.384+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] tor$SharedEntityManagerInvocationHandler : Creating new EntityManager for shared EntityManager invocation
2024-08-29T21:04:50.387+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] tor$SharedEntityManagerInvocationHandler : Creating new EntityManager for shared EntityManager invocation
2024-08-29T21:04:50.391+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class jdk.proxy3.$Proxy142
2024-08-29T21:04:50.392+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.example.walletservice.wallet.adapter.out.persistence.entity.JpaWalletMapper
2024-08-29T21:04:50.393+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.transaction.TransactionAutoConfiguration$TransactionTemplateConfiguration
2024-08-29T21:04:50.396+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.transaction.TransactionManagerCustomizationAutoConfiguration
2024-08-29T21:04:50.398+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.transaction.ExecutionListenersTransactionManagerCustomizer
2024-08-29T21:04:50.402+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.transaction.TransactionProperties
2024-08-29T21:04:50.403+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.transaction.TransactionManagerCustomizers
2024-08-29T21:04:50.409+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.orm.jpa.JpaTransactionManager
2024-08-29T21:04:50.411+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.transaction.support.TransactionTemplate
2024-08-29T21:04:50.419+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepository$$SpringCGLIB$$0
2024-08-29T21:04:50.420+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.example.walletservice.wallet.adapter.out.persistence.WalletPersistenceAdapter
2024-08-29T21:04:50.427+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] tor$SharedEntityManagerInvocationHandler : Creating new EntityManager for shared EntityManager invocation
2024-08-29T21:04:50.432+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] tor$SharedEntityManagerInvocationHandler : Creating new EntityManager for shared EntityManager invocation
2024-08-29T21:04:50.446+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] tor$SharedEntityManagerInvocationHandler : Creating new EntityManager for shared EntityManager invocation
2024-08-29T21:04:50.450+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class jdk.proxy3.$Proxy144
2024-08-29T21:04:50.452+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.example.walletservice.wallet.adapter.out.persistence.entity.JpaPaymentOrderMapper
2024-08-29T21:04:50.457+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaPaymentOrderRepository$$SpringCGLIB$$0
2024-08-29T21:04:50.458+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.example.walletservice.wallet.adapter.out.persistence.PaymentOrderPersistenceAdapter
2024-08-29T21:04:50.460+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.example.walletservice.wallet.application.service.SettlementService
2024-08-29T21:04:50.461+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.cloud.stream.function.FunctionConfiguration
2024-08-29T21:04:50.462+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.cloud.function.context.config.ContextFunctionCatalogAutoConfiguration
2024-08-29T21:04:50.463+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.cloud.stream.config.ContentTypeConfiguration
2024-08-29T21:04:50.470+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.integration.config.CustomConversionServiceFactoryBean
2024-08-29T21:04:50.471+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.core.convert.support.DefaultConversionService
2024-08-29T21:04:50.472+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.integration.support.converter.DefaultDatatypeChannelMessageConverter
2024-08-29T21:04:50.473+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.cloud.function.context.config.ContextFunctionCatalogAutoConfiguration$JsonMapperConfiguration
2024-08-29T21:04:50.475+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration$JacksonObjectMapperConfiguration
2024-08-29T21:04:50.476+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration$JacksonObjectMapperBuilderConfiguration
2024-08-29T21:04:50.477+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration$Jackson2ObjectMapperBuilderCustomizerConfiguration
2024-08-29T21:04:50.481+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.jackson.JacksonProperties
2024-08-29T21:04:50.482+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration$ParameterNamesModuleConfiguration
2024-08-29T21:04:50.486+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class com.fasterxml.jackson.module.paramnames.ParameterNamesModule
2024-08-29T21:04:50.488+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration$JacksonMixinConfiguration
2024-08-29T21:04:50.495+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.jackson.JsonMixinModuleEntries
2024-08-29T21:04:50.497+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.jackson.JsonMixinModule
2024-08-29T21:04:50.499+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration
2024-08-29T21:04:50.504+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.jackson.JsonComponentModule
2024-08-29T21:04:50.505+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.data.web.config.SpringDataJacksonConfiguration
2024-08-29T21:04:50.509+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.data.geo.GeoModule
2024-08-29T21:04:50.511+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.data.web.config.SpringDataJacksonConfiguration$PageModule
2024-08-29T21:04:50.512+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration$Jackson2ObjectMapperBuilderCustomizerConfiguration$StandardJackson2ObjectMapperBuilderCustomizer
2024-08-29T21:04:50.516+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.http.converter.json.Jackson2ObjectMapperBuilder
2024-08-29T21:04:50.534+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class com.fasterxml.jackson.databind.ObjectMapper
2024-08-29T21:04:50.539+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.cloud.function.json.JacksonMapper
2024-08-29T21:04:50.549+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.messaging.converter.CompositeMessageConverter
2024-08-29T21:04:50.551+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.cloud.function.cloudevent.CloudEventsFunctionExtensionConfiguration
2024-08-29T21:04:50.553+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.cloud.function.cloudevent.CloudEventsFunctionInvocationHelper
2024-08-29T21:04:50.559+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.cloud.function.context.FunctionProperties
2024-08-29T21:04:50.565+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.cloud.function.context.catalog.BeanFactoryAwareFunctionRegistry
2024-08-29T21:04:50.586+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.cloud.stream.config.BindingServiceProperties
2024-08-29T21:04:50.590+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.cloud.stream.config.BinderFactoryAutoConfiguration
2024-08-29T21:04:50.592+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.cloud.stream.binder.DefaultBinderTypeRegistry
2024-08-29T21:04:50.594+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.cloud.stream.binder.BinderChildContextInitializer
2024-08-29T21:04:50.597+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.cloud.stream.binder.DefaultBinderFactory
2024-08-29T21:04:50.598+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.integration.IntegrationAutoConfiguration$IntegrationTaskSchedulerConfiguration
2024-08-29T21:04:50.600+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.task.TaskSchedulingConfigurations$TaskSchedulerBuilderConfiguration
2024-08-29T21:04:50.602+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.task.TaskSchedulingProperties
2024-08-29T21:04:50.603+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.task.TaskSchedulerBuilder
2024-08-29T21:04:50.604+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.task.TaskSchedulingConfigurations$ThreadPoolTaskSchedulerBuilderConfiguration
2024-08-29T21:04:50.606+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.task.ThreadPoolTaskSchedulerBuilder
2024-08-29T21:04:50.615+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.scheduling.concurrent.ThreadPoolTaskScheduler
2024-08-29T21:04:50.620+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.cloud.stream.binding.BindingService
2024-08-29T21:04:50.622+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.cloud.stream.function.StreamBridge
2024-08-29T21:04:50.623+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.example.walletservice.wallet.adapter.in.stream.PaymentEventMessageHandler$$SpringCGLIB$$0
2024-08-29T21:04:50.624+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.example.walletservice.wallet.adapter.in.stream.PaymentEventMessageHandler$$Lambda$1624/0x0000000126a9d2d8
2024-08-29T21:04:50.625+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.context.PropertyPlaceholderAutoConfiguration
2024-08-29T21:04:50.627+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.ssl.SslProperties
2024-08-29T21:04:50.627+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.ssl.SslAutoConfiguration
2024-08-29T21:04:50.628+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.ssl.FileWatcher
2024-08-29T21:04:50.631+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.ssl.SslPropertiesBundleRegistrar
2024-08-29T21:04:50.637+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.ssl.DefaultSslBundleRegistry
2024-08-29T21:04:50.637+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.websocket.servlet.WebSocketServletAutoConfiguration$TomcatWebSocketConfiguration
2024-08-29T21:04:50.640+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.websocket.servlet.TomcatWebSocketServletWebServerCustomizer
2024-08-29T21:04:50.640+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.websocket.servlet.WebSocketServletAutoConfiguration
2024-08-29T21:04:50.641+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.web.servlet.ServletWebServerFactoryConfiguration$EmbeddedTomcat
2024-08-29T21:04:50.678+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.web.servlet.ServletWebServerFactoryAutoConfiguration
2024-08-29T21:04:50.692+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.web.ServerProperties
2024-08-29T21:04:50.695+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.web.servlet.ServletWebServerFactoryCustomizer
2024-08-29T21:04:50.696+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.web.servlet.TomcatServletWebServerFactoryCustomizer
2024-08-29T21:04:50.697+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.web.servlet.HttpEncodingAutoConfiguration
2024-08-29T21:04:50.698+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.web.servlet.HttpEncodingAutoConfiguration$LocaleCharsetMappingsCustomizer
2024-08-29T21:04:50.710+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.web.servlet.error.ErrorMvcAutoConfiguration
2024-08-29T21:04:50.711+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.web.servlet.DispatcherServletAutoConfiguration$DispatcherServletRegistrationConfiguration
2024-08-29T21:04:50.712+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.web.servlet.DispatcherServletAutoConfiguration$DispatcherServletConfiguration
2024-08-29T21:04:50.717+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties
2024-08-29T21:04:50.731+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.web.servlet.DispatcherServlet
2024-08-29T21:04:50.738+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.web.servlet.MultipartProperties
2024-08-29T21:04:50.739+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.web.servlet.MultipartAutoConfiguration
2024-08-29T21:04:50.741+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class jakarta.servlet.MultipartConfigElement
2024-08-29T21:04:50.743+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.web.servlet.DispatcherServletRegistrationBean
2024-08-29T21:04:50.745+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.web.servlet.error.ErrorMvcAutoConfiguration$ErrorPageCustomizer
2024-08-29T21:04:50.748+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.web.embedded.tomcat.TomcatServletWebServerFactory
2024-08-29T21:04:50.751+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.web.servlet.DispatcherServletAutoConfiguration
2024-08-29T21:04:50.751+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.task.TaskExecutorConfigurations$ThreadPoolTaskExecutorBuilderConfiguration
2024-08-29T21:04:50.753+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.task.TaskExecutionProperties
2024-08-29T21:04:50.756+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.task.ThreadPoolTaskExecutorBuilder
2024-08-29T21:04:50.757+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.task.TaskExecutorConfigurations$TaskExecutorBuilderConfiguration
2024-08-29T21:04:50.759+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.task.TaskExecutorBuilder
2024-08-29T21:04:50.760+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.task.TaskExecutorConfigurations$SimpleAsyncTaskExecutorBuilderConfiguration
2024-08-29T21:04:50.762+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.task.SimpleAsyncTaskExecutorBuilder
2024-08-29T21:04:50.764+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.task.TaskExecutorConfigurations$TaskExecutorConfiguration
2024-08-29T21:04:50.764+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.task.TaskExecutionAutoConfiguration
2024-08-29T21:04:50.765+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.validation.ValidationAutoConfiguration
2024-08-29T21:04:50.776+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.validation.beanvalidation.LocalValidatorFactoryBean
2024-08-29T21:04:50.778+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.web.servlet.error.ErrorMvcAutoConfiguration$WhitelabelErrorViewConfiguration
2024-08-29T21:04:50.779+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.web.servlet.error.ErrorMvcAutoConfiguration$StaticView
2024-08-29T21:04:50.781+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.web.servlet.view.BeanNameViewResolver
2024-08-29T21:04:50.785+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.web.WebProperties
2024-08-29T21:04:50.786+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.web.servlet.error.ErrorMvcAutoConfiguration$DefaultErrorViewResolverConfiguration
2024-08-29T21:04:50.788+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.web.servlet.error.DefaultErrorViewResolver
2024-08-29T21:04:50.790+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.web.servlet.error.DefaultErrorAttributes
2024-08-29T21:04:50.796+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.web.servlet.error.BasicErrorController
2024-08-29T21:04:50.803+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.web.servlet.WebMvcAutoConfiguration$WebMvcAutoConfigurationAdapter
2024-08-29T21:04:50.806+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.data.web.config.SpringDataWebConfiguration
2024-08-29T21:04:50.809+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.web.servlet.WebMvcAutoConfiguration$EnableWebMvcConfiguration
2024-08-29T21:04:50.818+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.web.format.WebConversionService
2024-08-29T21:04:50.821+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.web.servlet.resource.ResourceUrlProvider
2024-08-29T21:04:50.837+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.web.servlet.WelcomePageHandlerMapping
2024-08-29T21:04:50.843+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.web.servlet.WelcomePageNotAcceptableHandlerMapping
2024-08-29T21:04:50.845+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.web.servlet.i18n.AcceptHeaderLocaleResolver
2024-08-29T21:04:50.847+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.web.servlet.theme.FixedThemeResolver
2024-08-29T21:04:50.850+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.web.servlet.support.SessionFlashMapManager
2024-08-29T21:04:50.852+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.validation.ValidatorAdapter
2024-08-29T21:04:50.855+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.web.accept.ContentNegotiationManager
2024-08-29T21:04:50.895+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping
2024-08-29T21:04:50.898+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.web.util.pattern.PathPatternParser
2024-08-29T21:04:50.899+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.web.util.UrlPathHelper
2024-08-29T21:04:50.900+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.util.AntPathMatcher
2024-08-29T21:04:50.902+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.beans.factory.support.NullBean
2024-08-29T21:04:50.906+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.web.servlet.handler.BeanNameUrlHandlerMapping
2024-08-29T21:04:50.908+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.http.HttpMessageConvertersAutoConfiguration
2024-08-29T21:04:50.911+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.http.HttpMessageConvertersAutoConfiguration$StringHttpMessageConverterConfiguration
2024-08-29T21:04:50.915+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.http.converter.StringHttpMessageConverter
2024-08-29T21:04:50.916+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.http.JacksonHttpMessageConvertersConfiguration$MappingJackson2HttpMessageConverterConfiguration
2024-08-29T21:04:50.919+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.http.converter.json.MappingJackson2HttpMessageConverter
2024-08-29T21:04:50.922+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.http.HttpMessageConverters
2024-08-29T21:04:50.962+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.web.servlet.function.support.RouterFunctionMapping
2024-08-29T21:04:50.974+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.web.servlet.handler.SimpleUrlHandlerMapping
2024-08-29T21:04:50.985+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.data.web.SpringDataWebProperties
2024-08-29T21:04:50.986+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.data.web.SpringDataWebAutoConfiguration
2024-08-29T21:04:50.987+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.data.web.SpringDataWebAutoConfiguration$$Lambda$1747/0x0000000126af27a8
2024-08-29T21:04:50.988+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.data.web.SortHandlerMethodArgumentResolver
2024-08-29T21:04:50.991+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.data.web.SpringDataWebAutoConfiguration$$Lambda$1749/0x0000000126af3530
2024-08-29T21:04:50.992+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.data.web.PageableHandlerMethodArgumentResolver
2024-08-29T21:04:51.002+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor
2024-08-29T21:04:51.034+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter
2024-08-29T21:04:51.038+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.web.servlet.function.support.HandlerFunctionAdapter
2024-08-29T21:04:51.040+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.web.method.support.CompositeUriComponentsContributor
2024-08-29T21:04:51.041+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter
2024-08-29T21:04:51.042+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter
2024-08-29T21:04:51.046+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.web.servlet.handler.HandlerExceptionResolverComposite
2024-08-29T21:04:51.048+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.web.servlet.view.ViewResolverComposite
2024-08-29T21:04:51.050+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator
2024-08-29T21:04:51.055+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.web.servlet.view.InternalResourceViewResolver
2024-08-29T21:04:51.059+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.web.servlet.view.ContentNegotiatingViewResolver
2024-08-29T21:04:51.062+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.web.servlet.filter.OrderedRequestContextFilter
2024-08-29T21:04:51.063+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.web.servlet.WebMvcAutoConfiguration
2024-08-29T21:04:51.065+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.web.servlet.filter.OrderedFormContentFilter
2024-08-29T21:04:51.066+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.aop.AopAutoConfiguration$AspectJAutoProxyingConfiguration$CglibAutoProxyConfiguration
2024-08-29T21:04:51.066+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.aop.AopAutoConfiguration$AspectJAutoProxyingConfiguration
2024-08-29T21:04:51.067+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.aop.AopAutoConfiguration
2024-08-29T21:04:51.067+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.availability.ApplicationAvailabilityAutoConfiguration
2024-08-29T21:04:51.068+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.availability.ApplicationAvailabilityBean
2024-08-29T21:04:51.069+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.transaction.jta.JtaAutoConfiguration
2024-08-29T21:04:51.069+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.jdbc.metadata.DataSourcePoolMetadataProvidersConfiguration
2024-08-29T21:04:51.070+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration
2024-08-29T21:04:51.070+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.orm.jpa.JpaBaseConfiguration$PersistenceManagedTypesConfiguration
2024-08-29T21:04:51.070+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.orm.jpa.HibernateJpaAutoConfiguration
2024-08-29T21:04:51.071+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.context.ConfigurationPropertiesAutoConfiguration
2024-08-29T21:04:51.074+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.context.LifecycleAutoConfiguration
2024-08-29T21:04:51.076+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.context.LifecycleProperties
2024-08-29T21:04:51.078+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.context.support.DefaultLifecycleProcessor
2024-08-29T21:04:51.079+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.dao.PersistenceExceptionTranslationAutoConfiguration
2024-08-29T21:04:51.079+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.data.jpa.JpaRepositoriesAutoConfiguration
2024-08-29T21:04:51.080+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.data.jpa.util.JpaMetamodelCacheCleanup
2024-08-29T21:04:51.081+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.data.jpa.repository.support.JpaEvaluationContextExtension
2024-08-29T21:04:51.087+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.data.jpa.repository.config.JpaRepositoryConfigExtension$JpaRepositoryRegistrationAotProcessor
2024-08-29T21:04:51.088+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.http.JacksonHttpMessageConvertersConfiguration
2024-08-29T21:04:51.089+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.data.web.config.ProjectingArgumentResolverRegistrar
2024-08-29T21:04:51.091+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.data.web.OffsetScrollPositionHandlerMethodArgumentResolver
2024-08-29T21:04:51.096+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.info.ProjectInfoProperties
2024-08-29T21:04:51.097+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.info.ProjectInfoAutoConfiguration
2024-08-29T21:04:51.098+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.task.TaskSchedulingConfigurations$SimpleAsyncTaskSchedulerBuilderConfiguration
2024-08-29T21:04:51.103+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.task.SimpleAsyncTaskSchedulerBuilder
2024-08-29T21:04:51.104+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.task.TaskSchedulingAutoConfiguration
2024-08-29T21:04:51.105+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.integration.IntegrationAutoConfiguration$IntegrationComponentScanConfiguration
2024-08-29T21:04:51.106+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.integration.config.IntegrationComponentScanRegistrar
2024-08-29T21:04:51.107+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.integration.IntegrationAutoConfiguration$IntegrationManagementConfiguration$EnableIntegrationManagementConfiguration
2024-08-29T21:04:51.107+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.integration.IntegrationAutoConfiguration$IntegrationManagementConfiguration
2024-08-29T21:04:51.108+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.integration.IntegrationAutoConfiguration$IntegrationConfiguration
2024-08-29T21:04:51.117+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.integration.IntegrationProperties
2024-08-29T21:04:51.121+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.integration.scheduling.PollerMetadata
2024-08-29T21:04:51.122+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.integration.IntegrationAutoConfiguration
2024-08-29T21:04:51.126+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.integration.context.IntegrationProperties
2024-08-29T21:04:51.128+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.jmx.JmxProperties
2024-08-29T21:04:51.129+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.jdbc.JdbcTemplateConfiguration
2024-08-29T21:04:51.131+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.jdbc.JdbcProperties
2024-08-29T21:04:51.139+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.jdbc.core.JdbcTemplate
2024-08-29T21:04:51.142+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.jdbc.NamedParameterJdbcTemplateConfiguration
2024-08-29T21:04:51.148+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.jdbc.core.namedparam.NamedParameterJdbcTemplate
2024-08-29T21:04:51.150+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.jdbc.JdbcTemplateAutoConfiguration
2024-08-29T21:04:51.151+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.jdbc.JdbcClientAutoConfiguration
2024-08-29T21:04:51.152+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.jdbc.core.simple.DefaultJdbcClient
2024-08-29T21:04:51.153+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.kafka.KafkaAnnotationDrivenConfiguration$EnableKafkaConfiguration
2024-08-29T21:04:51.154+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.kafka.config.KafkaListenerEndpointRegistry
2024-08-29T21:04:51.167+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.kafka.KafkaProperties
2024-08-29T21:04:51.185+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.kafka.KafkaAutoConfiguration
2024-08-29T21:04:51.187+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.kafka.PropertiesKafkaConnectionDetails
2024-08-29T21:04:51.200+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.kafka.core.DefaultKafkaProducerFactory
2024-08-29T21:04:51.204+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.kafka.support.LoggingProducerListener
2024-08-29T21:04:51.220+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.kafka.core.KafkaTemplate
2024-08-29T21:04:51.228+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.kafka.KafkaAnnotationDrivenConfiguration
2024-08-29T21:04:51.231+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.kafka.ConcurrentKafkaListenerContainerFactoryConfigurer
2024-08-29T21:04:51.243+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.kafka.core.DefaultKafkaConsumerFactory
2024-08-29T21:04:51.254+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.kafka.config.ConcurrentKafkaListenerContainerFactory
2024-08-29T21:04:51.266+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.kafka.core.KafkaAdmin
2024-08-29T21:04:51.269+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.reactor.ReactorProperties
2024-08-29T21:04:51.270+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.reactor.ReactorAutoConfiguration
2024-08-29T21:04:51.270+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.sql.init.SqlInitializationAutoConfiguration
2024-08-29T21:04:51.271+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.jdbc.DataSourceTransactionManagerAutoConfiguration$JdbcTransactionManagerConfiguration
2024-08-29T21:04:51.271+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.jdbc.DataSourceTransactionManagerAutoConfiguration
2024-08-29T21:04:51.271+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.transaction.TransactionAutoConfiguration$EnableTransactionManagementConfiguration$CglibAutoProxyConfiguration
2024-08-29T21:04:51.272+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.transaction.TransactionAutoConfiguration$EnableTransactionManagementConfiguration
2024-08-29T21:04:51.273+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.transaction.TransactionAutoConfiguration
2024-08-29T21:04:51.273+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.web.client.RestClientAutoConfiguration
2024-08-29T21:04:51.274+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.web.client.HttpMessageConvertersRestClientCustomizer
2024-08-29T21:04:51.275+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.web.client.AutoConfiguredRestClientSsl
2024-08-29T21:04:51.276+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.web.client.RestClientBuilderConfigurer
2024-08-29T21:04:51.276+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.autoconfigure.web.client.RestTemplateAutoConfiguration
2024-08-29T21:04:51.278+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.boot.web.servlet.filter.OrderedCharacterEncodingFilter
2024-08-29T21:04:51.279+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.web.multipart.support.StandardServletMultipartResolver
2024-08-29T21:04:51.280+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.cloud.function.context.config.ContextFunctionCatalogAutoConfiguration$PlainFunctionScanConfiguration
2024-08-29T21:04:51.282+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.cloud.function.context.config.RoutingFunction
2024-08-29T21:04:51.283+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.cloud.function.context.config.KotlinLambdaToFunctionAutoConfiguration$$SpringCGLIB$$0
2024-08-29T21:04:51.295+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.messaging.handler.annotation.support.DefaultMessageHandlerMethodFactory
2024-08-29T21:04:51.297+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.cloud.stream.function.StreamFunctionConfigurationProperties
2024-08-29T21:04:51.297+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.cloud.stream.function.StreamFunctionProperties
2024-08-29T21:04:51.300+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.cloud.stream.binding.MessageConverterConfigurer
2024-08-29T21:04:51.301+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.cloud.stream.binding.CompositeMessageChannelConfigurer
2024-08-29T21:04:51.303+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.cloud.stream.binding.SubscribableChannelBindingTargetFactory
2024-08-29T21:04:51.305+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.cloud.stream.binding.FluxMessageChannelBindingTargetFactory
2024-08-29T21:04:51.306+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.cloud.stream.binding.MessageSourceBindingTargetFactory
2024-08-29T21:04:51.318+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.cloud.stream.function.FunctionConfiguration$FunctionBindingRegistrar
2024-08-29T21:04:51.330+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.cloud.stream.function.BindableFunctionProxyFactory
2024-08-29T21:04:51.371+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.integration.support.DefaultMessageBuilderFactory
2024-08-29T21:04:51.377+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.cloud.stream.messaging.DirectWithAttributesChannel
2024-08-29T21:04:51.384+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.integration.support.channel.BeanFactoryChannelResolver
2024-08-29T21:04:51.385+09:00  INFO 42267 --- [wallet-service] [    Test worker] o.s.c.s.m.DirectWithAttributesChannel    : Channel 'wallet-service.consume-in-0' has 1 subscriber(s).
2024-08-29T21:04:51.385+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.cloud.stream.function.FunctionConfiguration$FunctionToDestinationBinder
2024-08-29T21:04:51.397+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.cloud.stream.function.FunctionConfiguration$1
2024-08-29T21:04:51.400+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.integration.expression.SpelPropertyAccessorRegistrar
2024-08-29T21:04:51.402+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.cloud.stream.binding.DynamicDestinationsBindable
2024-08-29T21:04:51.403+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.cloud.stream.binding.OutputBindingLifecycle
2024-08-29T21:04:51.404+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.cloud.stream.binding.InputBindingLifecycle
2024-08-29T21:04:51.407+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.cloud.stream.binding.BindingsLifecycleController
2024-08-29T21:04:51.407+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.cloud.stream.binding.ContextStartAfterRefreshListener
2024-08-29T21:04:51.409+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.cloud.stream.config.SpringIntegrationProperties
2024-08-29T21:04:51.410+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.cloud.stream.config.BindingServiceConfiguration$2
2024-08-29T21:04:51.413+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.integration.channel.MessagePublishingErrorHandler
2024-08-29T21:04:51.415+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.integration.channel.NullChannel
2024-08-29T21:04:51.424+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.integration.channel.PublishSubscribeChannel
2024-08-29T21:04:51.433+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.integration.config.SpelFunctionFactoryBean
2024-08-29T21:04:51.434+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.integration.config.IntegrationEvaluationContextFactoryBean
2024-08-29T21:04:51.435+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.expression.spel.support.StandardEvaluationContext
2024-08-29T21:04:51.439+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.integration.handler.LoggingHandler
2024-08-29T21:04:51.443+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.integration.config.ConsumerEndpointFactoryBean
2024-08-29T21:04:51.444+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.integration.config.IntegrationSimpleEvaluationContextFactoryBean
2024-08-29T21:04:51.445+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.integration.config.IdGeneratorConfigurer
2024-08-29T21:04:51.446+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.integration.support.SmartLifecycleRoleController
2024-08-29T21:04:51.449+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.integration.channel.DefaultHeaderChannelRegistry
2024-08-29T21:04:51.452+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.integration.handler.support.IntegrationMessageHandlerMethodFactory
2024-08-29T21:04:51.452+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.integration.config.IntegrationConfigurationReport
2024-08-29T21:04:51.453+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.integration.config.ConverterRegistrar$IntegrationConverterRegistration
2024-08-29T21:04:51.456+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.integration.config.ConverterRegistrar
2024-08-29T21:04:51.457+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.integration.dsl.context.StandardIntegrationFlowContext
2024-08-29T21:04:51.475+09:00  INFO 42267 --- [wallet-service] [    Test worker] o.s.i.endpoint.EventDrivenConsumer       : Adding {logging-channel-adapter:_org.springframework.integration.errorLogger} as a subscriber to the 'errorChannel' channel
2024-08-29T21:04:51.475+09:00  INFO 42267 --- [wallet-service] [    Test worker] o.s.i.channel.PublishSubscribeChannel    : Channel 'wallet-service.errorChannel' has 1 subscriber(s).
2024-08-29T21:04:51.475+09:00  INFO 42267 --- [wallet-service] [    Test worker] o.s.i.endpoint.EventDrivenConsumer       : started bean '_org.springframework.integration.errorLogger'
2024-08-29T21:04:51.476+09:00  INFO 42267 --- [wallet-service] [    Test worker] o.s.c.s.binder.DefaultBinderFactory      : Creating binder: kafka
2024-08-29T21:04:51.476+09:00  INFO 42267 --- [wallet-service] [    Test worker] o.s.c.s.binder.DefaultBinderFactory      : Constructing binder child context for kafka
2024-08-29T21:04:51.586+09:00  INFO 42267 --- [wallet-service] [    Test worker] o.s.c.s.binder.DefaultBinderFactory      : Caching the binder: kafka
2024-08-29T21:04:51.612+09:00  INFO 42267 --- [wallet-service] [    Test worker] o.a.k.clients.consumer.ConsumerConfig    : ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 100
	auto.include.jmx.reporter = true
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-wallet-service-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = wallet-service
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.ByteArrayDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.ByteArrayDeserializer

2024-08-29T21:04:51.619+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] fkaConsumerFactory$ExtendedKafkaConsumer : [Consumer clientId=consumer-wallet-service-1, groupId=wallet-service] Initializing the Kafka consumer
2024-08-29T21:04:51.752+09:00  INFO 42267 --- [wallet-service] [    Test worker] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.6.2
2024-08-29T21:04:51.752+09:00  INFO 42267 --- [wallet-service] [    Test worker] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: c4deed513057c94e
2024-08-29T21:04:51.752+09:00  INFO 42267 --- [wallet-service] [    Test worker] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1724933091751
2024-08-29T21:04:51.753+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] fkaConsumerFactory$ExtendedKafkaConsumer : [Consumer clientId=consumer-wallet-service-1, groupId=wallet-service] Kafka consumer initialized
2024-08-29T21:04:52.068+09:00  INFO 42267 --- [wallet-service] [    Test worker] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-wallet-service-1, groupId=wallet-service] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2024-08-29T21:04:52.070+09:00 TRACE 42267 --- [wallet-service] [    Test worker] fkaConsumerFactory$ExtendedKafkaConsumer : [Consumer clientId=consumer-wallet-service-1, groupId=wallet-service] Closing the Kafka consumer
2024-08-29T21:04:52.071+09:00  INFO 42267 --- [wallet-service] [    Test worker] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet-service-1, groupId=wallet-service] Resetting generation and member id due to: consumer pro-actively leaving the group
2024-08-29T21:04:52.071+09:00  INFO 42267 --- [wallet-service] [    Test worker] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet-service-1, groupId=wallet-service] Request joining group due to: consumer pro-actively leaving the group
2024-08-29T21:04:52.072+09:00  INFO 42267 --- [wallet-service] [    Test worker] o.apache.kafka.common.metrics.Metrics    : Metrics scheduler closed
2024-08-29T21:04:52.073+09:00  INFO 42267 --- [wallet-service] [    Test worker] o.apache.kafka.common.metrics.Metrics    : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2024-08-29T21:04:52.073+09:00  INFO 42267 --- [wallet-service] [    Test worker] o.apache.kafka.common.metrics.Metrics    : Metrics reporters closed
2024-08-29T21:04:52.076+09:00  INFO 42267 --- [wallet-service] [    Test worker] o.a.kafka.common.utils.AppInfoParser     : App info kafka.consumer for consumer-wallet-service-1 unregistered
2024-08-29T21:04:52.077+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] fkaConsumerFactory$ExtendedKafkaConsumer : [Consumer clientId=consumer-wallet-service-1, groupId=wallet-service] Kafka consumer has been closed
2024-08-29T21:04:52.103+09:00  INFO 42267 --- [wallet-service] [    Test worker] o.s.c.stream.binder.BinderErrorChannel   : Channel 'kafka-220291510.consume-in-0.errors' has 1 subscriber(s).
2024-08-29T21:04:52.104+09:00  INFO 42267 --- [wallet-service] [    Test worker] o.s.c.stream.binder.BinderErrorChannel   : Channel 'kafka-220291510.consume-in-0.errors' has 0 subscriber(s).
2024-08-29T21:04:52.104+09:00  INFO 42267 --- [wallet-service] [    Test worker] o.s.c.stream.binder.BinderErrorChannel   : Channel 'kafka-220291510.consume-in-0.errors' has 1 subscriber(s).
2024-08-29T21:04:52.105+09:00  INFO 42267 --- [wallet-service] [    Test worker] o.s.c.stream.binder.BinderErrorChannel   : Channel 'kafka-220291510.consume-in-0.errors' has 2 subscriber(s).
2024-08-29T21:04:52.121+09:00  INFO 42267 --- [wallet-service] [    Test worker] o.a.k.clients.consumer.ConsumerConfig    : ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 100
	auto.include.jmx.reporter = true
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-wallet-service-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = wallet-service
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.ByteArrayDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.ByteArrayDeserializer

2024-08-29T21:04:52.122+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] fkaConsumerFactory$ExtendedKafkaConsumer : [Consumer clientId=consumer-wallet-service-2, groupId=wallet-service] Initializing the Kafka consumer
2024-08-29T21:04:52.127+09:00  INFO 42267 --- [wallet-service] [    Test worker] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.6.2
2024-08-29T21:04:52.127+09:00  INFO 42267 --- [wallet-service] [    Test worker] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: c4deed513057c94e
2024-08-29T21:04:52.127+09:00  INFO 42267 --- [wallet-service] [    Test worker] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1724933092127
2024-08-29T21:04:52.127+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] fkaConsumerFactory$ExtendedKafkaConsumer : [Consumer clientId=consumer-wallet-service-2, groupId=wallet-service] Kafka consumer initialized
2024-08-29T21:04:52.129+09:00  INFO 42267 --- [wallet-service] [    Test worker] fkaConsumerFactory$ExtendedKafkaConsumer : [Consumer clientId=consumer-wallet-service-2, groupId=wallet-service] Subscribed to topic(s): payment
2024-08-29T21:04:52.133+09:00  INFO 42267 --- [wallet-service] [    Test worker] s.i.k.i.KafkaMessageDrivenChannelAdapter : started org.springframework.integration.kafka.inbound.KafkaMessageDrivenChannelAdapter@294ffc88
2024-08-29T21:04:52.134+09:00 DEBUG 42267 --- [wallet-service] [container-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : Commit list: {}
2024-08-29T21:04:52.142+09:00  INFO 42267 --- [wallet-service] [container-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-wallet-service-2, groupId=wallet-service] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2024-08-29T21:04:52.143+09:00  INFO 42267 --- [wallet-service] [container-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet-service-2, groupId=wallet-service] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2024-08-29T21:04:52.145+09:00  INFO 42267 --- [wallet-service] [container-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet-service-2, groupId=wallet-service] (Re-)joining group
2024-08-29T21:04:52.145+09:00  INFO 42267 --- [wallet-service] [    Test worker] o.e.w.w.a.o.p.r.JpaWalletRepositoryTest  : Started JpaWalletRepositoryTest in 5.574 seconds (process running for 6.806)
2024-08-29T21:04:52.152+09:00 TRACE 42267 --- [wallet-service] [container-0-C-1] fkaConsumerFactory$ExtendedKafkaConsumer : [Consumer clientId=consumer-wallet-service-2, groupId=wallet-service] Polling for fetches with timeout 100
2024-08-29T21:04:52.155+09:00 TRACE 42267 --- [wallet-service] [container-0-C-1] fkaConsumerFactory$ExtendedKafkaConsumer : [Consumer clientId=consumer-wallet-service-2, groupId=wallet-service] Polling for fetches with timeout 100
2024-08-29T21:04:52.156+09:00 TRACE 42267 --- [wallet-service] [container-0-C-1] fkaConsumerFactory$ExtendedKafkaConsumer : [Consumer clientId=consumer-wallet-service-2, groupId=wallet-service] Polling for fetches with timeout 100
2024-08-29T21:04:52.157+09:00  INFO 42267 --- [wallet-service] [container-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet-service-2, groupId=wallet-service] Request joining group due to: need to re-join with the given member-id: consumer-wallet-service-2-da3655ef-7a7c-49a4-8a0e-200eeb8a4972
2024-08-29T21:04:52.158+09:00  INFO 42267 --- [wallet-service] [container-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet-service-2, groupId=wallet-service] Request joining group due to: rebalance failed due to 'The group member needs to have a valid member id before actually entering a consumer group.' (MemberIdRequiredException)
2024-08-29T21:04:52.158+09:00  INFO 42267 --- [wallet-service] [container-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet-service-2, groupId=wallet-service] (Re-)joining group
2024-08-29T21:04:52.158+09:00 TRACE 42267 --- [wallet-service] [container-0-C-1] fkaConsumerFactory$ExtendedKafkaConsumer : [Consumer clientId=consumer-wallet-service-2, groupId=wallet-service] Polling for fetches with timeout 100
2024-08-29T21:04:52.161+09:00  INFO 42267 --- [wallet-service] [container-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet-service-2, groupId=wallet-service] Successfully joined group with generation Generation{generationId=35, memberId='consumer-wallet-service-2-da3655ef-7a7c-49a4-8a0e-200eeb8a4972', protocol='range'}
2024-08-29T21:04:52.166+09:00  INFO 42267 --- [wallet-service] [container-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet-service-2, groupId=wallet-service] Finished assignment for group at generation 35: {consumer-wallet-service-2-da3655ef-7a7c-49a4-8a0e-200eeb8a4972=Assignment(partitions=[payment-0, payment-1, payment-2])}
2024-08-29T21:04:52.169+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepositoryTest
2024-08-29T21:04:52.169+09:00 TRACE 42267 --- [wallet-service] [container-0-C-1] fkaConsumerFactory$ExtendedKafkaConsumer : [Consumer clientId=consumer-wallet-service-2, groupId=wallet-service] Polling for fetches with timeout 100
2024-08-29T21:04:52.171+09:00  INFO 42267 --- [wallet-service] [container-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet-service-2, groupId=wallet-service] Successfully synced group in generation Generation{generationId=35, memberId='consumer-wallet-service-2-da3655ef-7a7c-49a4-8a0e-200eeb8a4972', protocol='range'}
2024-08-29T21:04:52.172+09:00  INFO 42267 --- [wallet-service] [container-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet-service-2, groupId=wallet-service] Notifying assignor about the new Assignment(partitions=[payment-0, payment-1, payment-2])
2024-08-29T21:04:52.174+09:00  INFO 42267 --- [wallet-service] [container-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet-service-2, groupId=wallet-service] Adding newly assigned partitions: payment-0, payment-1, payment-2
2024-08-29T21:04:52.183+09:00  INFO 42267 --- [wallet-service] [container-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet-service-2, groupId=wallet-service] Setting offset for partition payment-2 to the committed offset FetchPosition{offset=23, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=80}}
2024-08-29T21:04:52.183+09:00  INFO 42267 --- [wallet-service] [container-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet-service-2, groupId=wallet-service] Setting offset for partition payment-1 to the committed offset FetchPosition{offset=10, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=80}}
2024-08-29T21:04:52.183+09:00  INFO 42267 --- [wallet-service] [container-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-wallet-service-2, groupId=wallet-service] Setting offset for partition payment-0 to the committed offset FetchPosition{offset=12, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=80}}
2024-08-29T21:04:52.184+09:00  INFO 42267 --- [wallet-service] [container-0-C-1] o.s.c.s.b.k.KafkaMessageChannelBinder$2  : wallet-service: partitions assigned: [payment-0, payment-1, payment-2]
2024-08-29T21:04:52.187+09:00 TRACE 42267 --- [wallet-service] [container-0-C-1] fkaConsumerFactory$ExtendedKafkaConsumer : [Consumer clientId=consumer-wallet-service-2, groupId=wallet-service] Polling for fetches with timeout 2990
2024-08-29T21:04:52.189+09:00 TRACE 42267 --- [wallet-service] [container-0-C-1] fkaConsumerFactory$ExtendedKafkaConsumer : [Consumer clientId=consumer-wallet-service-2, groupId=wallet-service] Polling for fetches with timeout 2972
2024-08-29T21:04:52.189+09:00 TRACE 42267 --- [wallet-service] [container-0-C-1] fkaConsumerFactory$ExtendedKafkaConsumer : [Consumer clientId=consumer-wallet-service-2, groupId=wallet-service] Polling for fetches with timeout 2972
2024-08-29T21:04:52.192+09:00 TRACE 42267 --- [wallet-service] [container-0-C-1] fkaConsumerFactory$ExtendedKafkaConsumer : [Consumer clientId=consumer-wallet-service-2, groupId=wallet-service] Polling for fetches with timeout 2970
2024-08-29T21:04:52.192+09:00 TRACE 42267 --- [wallet-service] [container-0-C-1] fkaConsumerFactory$ExtendedKafkaConsumer : [Consumer clientId=consumer-wallet-service-2, groupId=wallet-service] Polling for fetches with timeout 2969
2024-08-29T21:04:52.705+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class org.springframework.integration.endpoint.EventDrivenConsumer
2024-08-29T21:04:52.707+09:00 TRACE 42267 --- [wallet-service] [    Test worker] KafkaListenerAnnotationBeanPostProcessor : No @KafkaListener annotations found on bean type: class java.lang.reflect.Method
2024-08-29T21:04:52.710+09:00 TRACE 42267 --- [wallet-service] [container-0-C-1] fkaConsumerFactory$ExtendedKafkaConsumer : [Consumer clientId=consumer-wallet-service-2, groupId=wallet-service] Polling for fetches with timeout 2459
2024-08-29T21:04:52.710+09:00 TRACE 42267 --- [wallet-service] [container-0-C-1] fkaConsumerFactory$ExtendedKafkaConsumer : [Consumer clientId=consumer-wallet-service-2, groupId=wallet-service] Polling for fetches with timeout 2451
2024-08-29T21:04:52.720+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Creating new transaction with name [org.springframework.data.jpa.repository.support.SimpleJpaRepository.deleteAll]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT
2024-08-29T21:04:52.721+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Opened new EntityManager [SessionImpl(2021874006<open>)] for JPA transaction
2024-08-29T21:04:52.727+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@689f60ea]
2024-08-29T21:04:52.727+09:00 TRACE 42267 --- [wallet-service] [    Test worker] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.deleteAll]
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0
2024-08-29T21:04:52.858+09:00 TRACE 42267 --- [wallet-service] [    Test worker] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.deleteAll]
2024-08-29T21:04:52.858+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction commit
2024-08-29T21:04:52.858+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Committing JPA transaction on EntityManager [SessionImpl(2021874006<open>)]
Hibernate: 
    delete 
    from
        wallets 
    where
        id=? 
        and version=?
Hibernate: 
    delete 
    from
        wallets 
    where
        id=? 
        and version=?
2024-08-29T21:04:52.884+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Closing JPA EntityManager [SessionImpl(2021874006<open>)] after transaction
2024-08-29T21:04:52.884+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Creating new transaction with name [org.springframework.data.jpa.repository.support.SimpleJpaRepository.deleteAll]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT
2024-08-29T21:04:52.884+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Opened new EntityManager [SessionImpl(367585412<open>)] for JPA transaction
2024-08-29T21:04:52.885+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@4fa1bdd0]
2024-08-29T21:04:52.885+09:00 TRACE 42267 --- [wallet-service] [    Test worker] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.deleteAll]
Hibernate: 
    select
        jwte1_0.id,
        jwte1_0.amount,
        jwte1_0.idempotency_key,
        jwte1_0.order_id,
        jwte1_0.reference_id,
        jwte1_0.reference_type,
        jwte1_0.type,
        jwte1_0.wallet_id 
    from
        wallet_transactions jwte1_0
2024-08-29T21:04:52.889+09:00 TRACE 42267 --- [wallet-service] [    Test worker] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.deleteAll]
2024-08-29T21:04:52.889+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction commit
2024-08-29T21:04:52.889+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Committing JPA transaction on EntityManager [SessionImpl(367585412<open>)]
Hibernate: 
    delete 
    from
        wallet_transactions 
    where
        id=?
Hibernate: 
    delete 
    from
        wallet_transactions 
    where
        id=?
Hibernate: 
    delete 
    from
        wallet_transactions 
    where
        id=?
Hibernate: 
    delete 
    from
        wallet_transactions 
    where
        id=?
2024-08-29T21:04:52.900+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Closing JPA EntityManager [SessionImpl(367585412<open>)] after transaction
2024-08-29T21:04:52.904+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Creating new transaction with name [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT
2024-08-29T21:04:52.905+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Opened new EntityManager [SessionImpl(540278073<open>)] for JPA transaction
2024-08-29T21:04:52.906+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@1f41742f]
2024-08-29T21:04:52.906+09:00 TRACE 42267 --- [wallet-service] [    Test worker] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
Hibernate: 
    insert 
    into
        wallets
        (balance, user_id, version) 
    values
        (?, ?, ?)
Hibernate: 
    insert 
    into
        wallets
        (balance, user_id, version) 
    values
        (?, ?, ?)
2024-08-29T21:04:52.922+09:00 TRACE 42267 --- [wallet-service] [    Test worker] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:52.922+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction commit
2024-08-29T21:04:52.922+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Committing JPA transaction on EntityManager [SessionImpl(540278073<open>)]
2024-08-29T21:04:52.927+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Closing JPA EntityManager [SessionImpl(540278073<open>)] after transaction
2024-08-29T21:04:52.930+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-3] o.s.orm.jpa.JpaTransactionManager        : Creating new transaction with name [null]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT
2024-08-29T21:04:52.930+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-2] o.s.orm.jpa.JpaTransactionManager        : Creating new transaction with name [null]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT
2024-08-29T21:04:52.930+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-1] o.s.orm.jpa.JpaTransactionManager        : Creating new transaction with name [null]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT
2024-08-29T21:04:52.931+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-2] o.s.orm.jpa.JpaTransactionManager        : Opened new EntityManager [SessionImpl(1363248548<open>)] for JPA transaction
2024-08-29T21:04:52.930+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-3] o.s.orm.jpa.JpaTransactionManager        : Opened new EntityManager [SessionImpl(373171547<open>)] for JPA transaction
2024-08-29T21:04:52.931+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-1] o.s.orm.jpa.JpaTransactionManager        : Opened new EntityManager [SessionImpl(579468420<open>)] for JPA transaction
2024-08-29T21:04:52.932+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-2] o.s.orm.jpa.JpaTransactionManager        : Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@144301e8]
2024-08-29T21:04:52.933+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-2] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(1363248548<open>)] for JPA transaction
2024-08-29T21:04:52.933+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-2] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:52.933+09:00 TRACE 42267 --- [wallet-service] [pool-2-thread-2] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:52.933+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-1] o.s.orm.jpa.JpaTransactionManager        : Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@57243da9]
2024-08-29T21:04:52.933+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-3] o.s.orm.jpa.JpaTransactionManager        : Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@18f9c9ec]
2024-08-29T21:04:52.933+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-1] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(579468420<open>)] for JPA transaction
2024-08-29T21:04:52.933+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-3] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(373171547<open>)] for JPA transaction
2024-08-29T21:04:52.933+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-1] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:52.934+09:00 TRACE 42267 --- [wallet-service] [pool-2-thread-1] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:52.934+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-3] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:52.934+09:00 TRACE 42267 --- [wallet-service] [pool-2-thread-3] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
2024-08-29T21:04:52.944+09:00 TRACE 42267 --- [wallet-service] [pool-2-thread-3] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:52.944+09:00 TRACE 42267 --- [wallet-service] [pool-2-thread-1] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:52.944+09:00 TRACE 42267 --- [wallet-service] [pool-2-thread-2] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:52.945+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-3] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(373171547<open>)] for JPA transaction
2024-08-29T21:04:52.945+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-1] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(579468420<open>)] for JPA transaction
2024-08-29T21:04:52.945+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-3] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:52.945+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-1] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:52.945+09:00 TRACE 42267 --- [wallet-service] [pool-2-thread-3] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:52.945+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-2] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(1363248548<open>)] for JPA transaction
2024-08-29T21:04:52.945+09:00 TRACE 42267 --- [wallet-service] [pool-2-thread-1] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:52.945+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-2] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:52.945+09:00 TRACE 42267 --- [wallet-service] [pool-2-thread-2] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:52.955+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-2] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(1363248548<open>)] for JPA transaction
2024-08-29T21:04:52.955+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-3] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(373171547<open>)] for JPA transaction
2024-08-29T21:04:52.955+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-1] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(579468420<open>)] for JPA transaction
2024-08-29T21:04:52.955+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-2] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:52.956+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-1] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:52.956+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-3] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:52.956+09:00 TRACE 42267 --- [wallet-service] [pool-2-thread-2] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:52.956+09:00 TRACE 42267 --- [wallet-service] [pool-2-thread-1] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:52.956+09:00 TRACE 42267 --- [wallet-service] [pool-2-thread-3] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
2024-08-29T21:04:52.963+09:00 TRACE 42267 --- [wallet-service] [pool-2-thread-3] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:52.963+09:00 TRACE 42267 --- [wallet-service] [pool-2-thread-1] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:52.963+09:00 TRACE 42267 --- [wallet-service] [pool-2-thread-2] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:52.963+09:00 TRACE 42267 --- [wallet-service] [pool-2-thread-3] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:52.963+09:00 TRACE 42267 --- [wallet-service] [pool-2-thread-1] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:52.963+09:00 TRACE 42267 --- [wallet-service] [pool-2-thread-2] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:52.963+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-3] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction commit
2024-08-29T21:04:52.964+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-1] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction commit
2024-08-29T21:04:52.964+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-2] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction commit
2024-08-29T21:04:52.964+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-3] o.s.orm.jpa.JpaTransactionManager        : Committing JPA transaction on EntityManager [SessionImpl(373171547<open>)]
2024-08-29T21:04:52.964+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-2] o.s.orm.jpa.JpaTransactionManager        : Committing JPA transaction on EntityManager [SessionImpl(1363248548<open>)]
2024-08-29T21:04:52.964+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-1] o.s.orm.jpa.JpaTransactionManager        : Committing JPA transaction on EntityManager [SessionImpl(579468420<open>)]
Hibernate: 
    update
        wallets 
    set
        balance=?,
        user_id=?,
        version=? 
    where
        id=? 
        and version=?
Hibernate: 
    update
        wallets 
    set
        balance=?,
        user_id=?,
        version=? 
    where
        id=? 
        and version=?
Hibernate: 
    update
        wallets 
    set
        balance=?,
        user_id=?,
        version=? 
    where
        id=? 
        and version=?
Hibernate: 
    update
        wallets 
    set
        balance=?,
        user_id=?,
        version=? 
    where
        id=? 
        and version=?
2024-08-29T21:04:52.981+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-2] o.s.orm.jpa.JpaTransactionManager        : Closing JPA EntityManager [SessionImpl(1363248548<open>)] after transaction
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
2024-08-29T21:04:52.997+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-1] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction rollback after commit exception

org.springframework.orm.ObjectOptimisticLockingFailureException: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect) : [org.example.walletservice.wallet.adapter.out.persistence.entity.JpaWalletEntity#34]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:325) ~[spring-orm-6.1.12.jar:6.1.12]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:244) ~[spring-orm-6.1.12.jar:6.1.12]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:566) ~[spring-orm-6.1.12.jar:6.1.12]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:795) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:152) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepository.performSaveOperation(JpaWalletRepository.kt:37) ~[main/:na]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepository.save(JpaWalletRepository.kt:29) ~[main/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:355) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:768) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:768) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:720) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepository$$SpringCGLIB$$0.save(<generated>) ~[main/:na]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepositoryTest.should_update_the_balance_of_wallet_successfully_when_execute_the_updated_command_at_the_same_time$lambda$0(JpaWalletRepositoryTest.kt:87) ~[test/:na]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]
Caused by: org.hibernate.StaleObjectStateException: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect) : [org.example.walletservice.wallet.adapter.out.persistence.entity.JpaWalletEntity#34]
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.identifiedResultsCheck(ModelMutationHelper.java:75) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.lambda$doStaticUpdate$8(UpdateCoordinatorStandard.java:782) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.checkResults(ModelMutationHelper.java:50) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:115) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:40) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:52) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.doStaticUpdate(UpdateCoordinatorStandard.java:778) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.performUpdate(UpdateCoordinatorStandard.java:324) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.coordinateUpdate(UpdateCoordinatorStandard.java:242) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.AbstractEntityPersister.update(AbstractEntityPersister.java:2804) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.action.internal.EntityUpdateAction.execute(EntityUpdateAction.java:168) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:632) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:499) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:377) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:41) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1407) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:488) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2329) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1986) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:562) ~[spring-orm-6.1.12.jar:6.1.12]
	... 24 common frames omitted

2024-08-29T21:04:52.997+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-3] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction rollback after commit exception

org.springframework.orm.ObjectOptimisticLockingFailureException: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect) : [org.example.walletservice.wallet.adapter.out.persistence.entity.JpaWalletEntity#34]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:325) ~[spring-orm-6.1.12.jar:6.1.12]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:244) ~[spring-orm-6.1.12.jar:6.1.12]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:566) ~[spring-orm-6.1.12.jar:6.1.12]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:795) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:152) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepository.performSaveOperation(JpaWalletRepository.kt:37) ~[main/:na]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepository.save(JpaWalletRepository.kt:29) ~[main/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:355) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:768) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:768) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:720) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepository$$SpringCGLIB$$0.save(<generated>) ~[main/:na]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepositoryTest.should_update_the_balance_of_wallet_successfully_when_execute_the_updated_command_at_the_same_time$lambda$2(JpaWalletRepositoryTest.kt:89) ~[test/:na]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]
Caused by: org.hibernate.StaleObjectStateException: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect) : [org.example.walletservice.wallet.adapter.out.persistence.entity.JpaWalletEntity#34]
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.identifiedResultsCheck(ModelMutationHelper.java:75) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.lambda$doStaticUpdate$8(UpdateCoordinatorStandard.java:782) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.checkResults(ModelMutationHelper.java:50) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:115) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:40) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:52) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.doStaticUpdate(UpdateCoordinatorStandard.java:778) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.performUpdate(UpdateCoordinatorStandard.java:324) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.coordinateUpdate(UpdateCoordinatorStandard.java:242) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.AbstractEntityPersister.update(AbstractEntityPersister.java:2804) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.action.internal.EntityUpdateAction.execute(EntityUpdateAction.java:168) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:632) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:499) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:377) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:41) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1407) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:488) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2329) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1986) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:562) ~[spring-orm-6.1.12.jar:6.1.12]
	... 24 common frames omitted

2024-08-29T21:04:53.004+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-3] o.s.orm.jpa.JpaTransactionManager        : Rolling back JPA transaction on EntityManager [SessionImpl(373171547<open>)]
2024-08-29T21:04:53.004+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-1] o.s.orm.jpa.JpaTransactionManager        : Rolling back JPA transaction on EntityManager [SessionImpl(579468420<open>)]
2024-08-29T21:04:53.005+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-3] o.s.orm.jpa.JpaTransactionManager        : Closing JPA EntityManager [SessionImpl(373171547<open>)] after transaction
2024-08-29T21:04:53.005+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-1] o.s.orm.jpa.JpaTransactionManager        : Closing JPA EntityManager [SessionImpl(579468420<open>)] after transaction
2024-08-29T21:04:53.007+09:00 TRACE 42267 --- [wallet-service] [pool-2-thread-3] o.s.t.i.TransactionInterceptor           : No need to create transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.findByIdIn]: This method is not transactional.
2024-08-29T21:04:53.007+09:00 TRACE 42267 --- [wallet-service] [pool-2-thread-1] o.s.t.i.TransactionInterceptor           : No need to create transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.findByIdIn]: This method is not transactional.
2024-08-29T21:04:53.010+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-3] tor$SharedEntityManagerInvocationHandler : Creating new EntityManager for shared EntityManager invocation
2024-08-29T21:04:53.046+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-1] tor$SharedEntityManagerInvocationHandler : Creating new EntityManager for shared EntityManager invocation
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id in (?, ?)
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id in (?, ?)
2024-08-29T21:04:53.063+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-1] o.s.orm.jpa.JpaTransactionManager        : Creating new transaction with name [null]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT
2024-08-29T21:04:53.063+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-3] o.s.orm.jpa.JpaTransactionManager        : Creating new transaction with name [null]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT
2024-08-29T21:04:53.063+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-1] o.s.orm.jpa.JpaTransactionManager        : Opened new EntityManager [SessionImpl(1600464595<open>)] for JPA transaction
2024-08-29T21:04:53.063+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-3] o.s.orm.jpa.JpaTransactionManager        : Opened new EntityManager [SessionImpl(1106203176<open>)] for JPA transaction
2024-08-29T21:04:53.064+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-3] o.s.orm.jpa.JpaTransactionManager        : Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@2121f94e]
2024-08-29T21:04:53.064+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-1] o.s.orm.jpa.JpaTransactionManager        : Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@4176df67]
2024-08-29T21:04:53.065+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-3] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(1106203176<open>)] for JPA transaction
2024-08-29T21:04:53.065+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-1] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(1600464595<open>)] for JPA transaction
2024-08-29T21:04:53.065+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-3] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.065+09:00 TRACE 42267 --- [wallet-service] [pool-2-thread-3] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.065+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-1] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.065+09:00 TRACE 42267 --- [wallet-service] [pool-2-thread-1] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
2024-08-29T21:04:53.070+09:00 TRACE 42267 --- [wallet-service] [pool-2-thread-3] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.070+09:00 TRACE 42267 --- [wallet-service] [pool-2-thread-1] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.070+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-3] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(1106203176<open>)] for JPA transaction
2024-08-29T21:04:53.070+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-3] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.070+09:00 TRACE 42267 --- [wallet-service] [pool-2-thread-3] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:53.070+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-1] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(1600464595<open>)] for JPA transaction
2024-08-29T21:04:53.070+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-1] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.070+09:00 TRACE 42267 --- [wallet-service] [pool-2-thread-1] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:53.070+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-3] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(1106203176<open>)] for JPA transaction
2024-08-29T21:04:53.070+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-3] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.070+09:00 TRACE 42267 --- [wallet-service] [pool-2-thread-3] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.071+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-1] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(1600464595<open>)] for JPA transaction
2024-08-29T21:04:53.071+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-1] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.071+09:00 TRACE 42267 --- [wallet-service] [pool-2-thread-1] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
2024-08-29T21:04:53.076+09:00 TRACE 42267 --- [wallet-service] [pool-2-thread-3] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.076+09:00 TRACE 42267 --- [wallet-service] [pool-2-thread-3] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:53.076+09:00 TRACE 42267 --- [wallet-service] [pool-2-thread-1] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.076+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-3] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction commit
2024-08-29T21:04:53.076+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-3] o.s.orm.jpa.JpaTransactionManager        : Committing JPA transaction on EntityManager [SessionImpl(1106203176<open>)]
2024-08-29T21:04:53.076+09:00 TRACE 42267 --- [wallet-service] [pool-2-thread-1] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:53.076+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-1] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction commit
2024-08-29T21:04:53.076+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-1] o.s.orm.jpa.JpaTransactionManager        : Committing JPA transaction on EntityManager [SessionImpl(1600464595<open>)]
Hibernate: 
    update
        wallets 
    set
        balance=?,
        user_id=?,
        version=? 
    where
        id=? 
        and version=?
Hibernate: 
    update
        wallets 
    set
        balance=?,
        user_id=?,
        version=? 
    where
        id=? 
        and version=?
Hibernate: 
    update
        wallets 
    set
        balance=?,
        user_id=?,
        version=? 
    where
        id=? 
        and version=?
2024-08-29T21:04:53.085+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-1] o.s.orm.jpa.JpaTransactionManager        : Closing JPA EntityManager [SessionImpl(1600464595<open>)] after transaction
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
2024-08-29T21:04:53.089+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-3] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction rollback after commit exception

org.springframework.orm.ObjectOptimisticLockingFailureException: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect) : [org.example.walletservice.wallet.adapter.out.persistence.entity.JpaWalletEntity#34]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:325) ~[spring-orm-6.1.12.jar:6.1.12]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:244) ~[spring-orm-6.1.12.jar:6.1.12]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:566) ~[spring-orm-6.1.12.jar:6.1.12]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:795) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:152) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepository.performSaveOperationWithRecent(JpaWalletRepository.kt:69) ~[main/:na]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepository.retrySaveOperation(JpaWalletRepository.kt:48) ~[main/:na]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepository.retrySaveOperation$default(JpaWalletRepository.kt:43) ~[main/:na]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepository.save(JpaWalletRepository.kt:31) ~[main/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:355) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:768) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:768) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:720) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepository$$SpringCGLIB$$0.save(<generated>) ~[main/:na]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepositoryTest.should_update_the_balance_of_wallet_successfully_when_execute_the_updated_command_at_the_same_time$lambda$2(JpaWalletRepositoryTest.kt:89) ~[test/:na]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]
Caused by: org.hibernate.StaleObjectStateException: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect) : [org.example.walletservice.wallet.adapter.out.persistence.entity.JpaWalletEntity#34]
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.identifiedResultsCheck(ModelMutationHelper.java:75) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.lambda$doStaticUpdate$8(UpdateCoordinatorStandard.java:782) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.checkResults(ModelMutationHelper.java:50) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:115) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:40) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:52) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.doStaticUpdate(UpdateCoordinatorStandard.java:778) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.performUpdate(UpdateCoordinatorStandard.java:324) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.coordinateUpdate(UpdateCoordinatorStandard.java:242) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.AbstractEntityPersister.update(AbstractEntityPersister.java:2804) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.action.internal.EntityUpdateAction.execute(EntityUpdateAction.java:168) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:632) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:499) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:377) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:41) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1407) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:488) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2329) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1986) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:562) ~[spring-orm-6.1.12.jar:6.1.12]
	... 26 common frames omitted

2024-08-29T21:04:53.090+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-3] o.s.orm.jpa.JpaTransactionManager        : Rolling back JPA transaction on EntityManager [SessionImpl(1106203176<open>)]
2024-08-29T21:04:53.090+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-3] o.s.orm.jpa.JpaTransactionManager        : Closing JPA EntityManager [SessionImpl(1106203176<open>)] after transaction
2024-08-29T21:04:53.119+09:00 TRACE 42267 --- [wallet-service] [pool-2-thread-3] o.s.t.i.TransactionInterceptor           : No need to create transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.findByIdIn]: This method is not transactional.
2024-08-29T21:04:53.120+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-3] tor$SharedEntityManagerInvocationHandler : Creating new EntityManager for shared EntityManager invocation
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id in (?, ?)
2024-08-29T21:04:53.123+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-3] o.s.orm.jpa.JpaTransactionManager        : Creating new transaction with name [null]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT
2024-08-29T21:04:53.123+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-3] o.s.orm.jpa.JpaTransactionManager        : Opened new EntityManager [SessionImpl(270739170<open>)] for JPA transaction
2024-08-29T21:04:53.123+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-3] o.s.orm.jpa.JpaTransactionManager        : Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@2294255a]
2024-08-29T21:04:53.124+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-3] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(270739170<open>)] for JPA transaction
2024-08-29T21:04:53.124+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-3] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.124+09:00 TRACE 42267 --- [wallet-service] [pool-2-thread-3] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
2024-08-29T21:04:53.128+09:00 TRACE 42267 --- [wallet-service] [pool-2-thread-3] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.128+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-3] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(270739170<open>)] for JPA transaction
2024-08-29T21:04:53.128+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-3] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.128+09:00 TRACE 42267 --- [wallet-service] [pool-2-thread-3] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:53.129+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-3] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(270739170<open>)] for JPA transaction
2024-08-29T21:04:53.129+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-3] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.129+09:00 TRACE 42267 --- [wallet-service] [pool-2-thread-3] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
2024-08-29T21:04:53.134+09:00 TRACE 42267 --- [wallet-service] [pool-2-thread-3] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.134+09:00 TRACE 42267 --- [wallet-service] [pool-2-thread-3] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:53.134+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-3] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction commit
2024-08-29T21:04:53.134+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-3] o.s.orm.jpa.JpaTransactionManager        : Committing JPA transaction on EntityManager [SessionImpl(270739170<open>)]
Hibernate: 
    update
        wallets 
    set
        balance=?,
        user_id=?,
        version=? 
    where
        id=? 
        and version=?
Hibernate: 
    update
        wallets 
    set
        balance=?,
        user_id=?,
        version=? 
    where
        id=? 
        and version=?
2024-08-29T21:04:53.144+09:00 DEBUG 42267 --- [wallet-service] [pool-2-thread-3] o.s.orm.jpa.JpaTransactionManager        : Closing JPA EntityManager [SessionImpl(270739170<open>)] after transaction
2024-08-29T21:04:53.145+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Creating new transaction with name [org.springframework.data.jpa.repository.support.SimpleJpaRepository.findById]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT,readOnly
2024-08-29T21:04:53.145+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Opened new EntityManager [SessionImpl(557076900<open>)] for JPA transaction
2024-08-29T21:04:53.148+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@403ca4ec]
2024-08-29T21:04:53.148+09:00 TRACE 42267 --- [wallet-service] [    Test worker] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.findById]
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
2024-08-29T21:04:53.151+09:00 TRACE 42267 --- [wallet-service] [    Test worker] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.findById]
2024-08-29T21:04:53.151+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction commit
2024-08-29T21:04:53.151+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Committing JPA transaction on EntityManager [SessionImpl(557076900<open>)]
2024-08-29T21:04:53.154+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Closing JPA EntityManager [SessionImpl(557076900<open>)] after transaction
2024-08-29T21:04:53.154+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Creating new transaction with name [org.springframework.data.jpa.repository.support.SimpleJpaRepository.findById]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT,readOnly
2024-08-29T21:04:53.155+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Opened new EntityManager [SessionImpl(150457292<open>)] for JPA transaction
2024-08-29T21:04:53.157+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@10b9956a]
2024-08-29T21:04:53.157+09:00 TRACE 42267 --- [wallet-service] [    Test worker] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.findById]
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
2024-08-29T21:04:53.160+09:00 TRACE 42267 --- [wallet-service] [    Test worker] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.findById]
2024-08-29T21:04:53.160+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction commit
2024-08-29T21:04:53.160+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Committing JPA transaction on EntityManager [SessionImpl(150457292<open>)]
2024-08-29T21:04:53.163+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Closing JPA EntityManager [SessionImpl(150457292<open>)] after transaction
2024-08-29T21:04:53.213+09:00 TRACE 42267 --- [wallet-service] [container-0-C-1] fkaConsumerFactory$ExtendedKafkaConsumer : [Consumer clientId=consumer-wallet-service-2, groupId=wallet-service] Polling for fetches with timeout 1949
2024-08-29T21:04:53.214+09:00 TRACE 42267 --- [wallet-service] [container-0-C-1] fkaConsumerFactory$ExtendedKafkaConsumer : [Consumer clientId=consumer-wallet-service-2, groupId=wallet-service] Polling for fetches with timeout 1948
2024-08-29T21:04:53.252+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Creating new transaction with name [org.springframework.data.jpa.repository.support.SimpleJpaRepository.deleteAll]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT
2024-08-29T21:04:53.252+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Opened new EntityManager [SessionImpl(417764437<open>)] for JPA transaction
2024-08-29T21:04:53.253+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@4e850e68]
2024-08-29T21:04:53.253+09:00 TRACE 42267 --- [wallet-service] [    Test worker] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.deleteAll]
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0
2024-08-29T21:04:53.256+09:00 TRACE 42267 --- [wallet-service] [    Test worker] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.deleteAll]
2024-08-29T21:04:53.256+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction commit
2024-08-29T21:04:53.256+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Committing JPA transaction on EntityManager [SessionImpl(417764437<open>)]
Hibernate: 
    delete 
    from
        wallets 
    where
        id=? 
        and version=?
Hibernate: 
    delete 
    from
        wallets 
    where
        id=? 
        and version=?
2024-08-29T21:04:53.264+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Closing JPA EntityManager [SessionImpl(417764437<open>)] after transaction
2024-08-29T21:04:53.264+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Creating new transaction with name [org.springframework.data.jpa.repository.support.SimpleJpaRepository.deleteAll]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT
2024-08-29T21:04:53.264+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Opened new EntityManager [SessionImpl(508378158<open>)] for JPA transaction
2024-08-29T21:04:53.265+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@593fcbe7]
2024-08-29T21:04:53.265+09:00 TRACE 42267 --- [wallet-service] [    Test worker] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.deleteAll]
Hibernate: 
    select
        jwte1_0.id,
        jwte1_0.amount,
        jwte1_0.idempotency_key,
        jwte1_0.order_id,
        jwte1_0.reference_id,
        jwte1_0.reference_type,
        jwte1_0.type,
        jwte1_0.wallet_id 
    from
        wallet_transactions jwte1_0
2024-08-29T21:04:53.269+09:00 TRACE 42267 --- [wallet-service] [    Test worker] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.deleteAll]
2024-08-29T21:04:53.269+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction commit
2024-08-29T21:04:53.269+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Committing JPA transaction on EntityManager [SessionImpl(508378158<open>)]
Hibernate: 
    delete 
    from
        wallet_transactions 
    where
        id=?
Hibernate: 
    delete 
    from
        wallet_transactions 
    where
        id=?
Hibernate: 
    delete 
    from
        wallet_transactions 
    where
        id=?
Hibernate: 
    delete 
    from
        wallet_transactions 
    where
        id=?
Hibernate: 
    delete 
    from
        wallet_transactions 
    where
        id=?
Hibernate: 
    delete 
    from
        wallet_transactions 
    where
        id=?
2024-08-29T21:04:53.284+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Closing JPA EntityManager [SessionImpl(508378158<open>)] after transaction
2024-08-29T21:04:53.284+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Creating new transaction with name [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT
2024-08-29T21:04:53.284+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Opened new EntityManager [SessionImpl(1651144763<open>)] for JPA transaction
2024-08-29T21:04:53.285+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@5563630d]
2024-08-29T21:04:53.285+09:00 TRACE 42267 --- [wallet-service] [    Test worker] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
Hibernate: 
    insert 
    into
        wallets
        (balance, user_id, version) 
    values
        (?, ?, ?)
Hibernate: 
    insert 
    into
        wallets
        (balance, user_id, version) 
    values
        (?, ?, ?)
2024-08-29T21:04:53.289+09:00 TRACE 42267 --- [wallet-service] [    Test worker] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.289+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction commit
2024-08-29T21:04:53.289+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Committing JPA transaction on EntityManager [SessionImpl(1651144763<open>)]
2024-08-29T21:04:53.293+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Closing JPA EntityManager [SessionImpl(1651144763<open>)] after transaction
2024-08-29T21:04:53.294+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-1] o.s.orm.jpa.JpaTransactionManager        : Creating new transaction with name [null]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT
2024-08-29T21:04:53.294+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-2] o.s.orm.jpa.JpaTransactionManager        : Creating new transaction with name [null]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT
2024-08-29T21:04:53.294+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-1] o.s.orm.jpa.JpaTransactionManager        : Opened new EntityManager [SessionImpl(1621345139<open>)] for JPA transaction
2024-08-29T21:04:53.294+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-3] o.s.orm.jpa.JpaTransactionManager        : Creating new transaction with name [null]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT
2024-08-29T21:04:53.294+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-3] o.s.orm.jpa.JpaTransactionManager        : Opened new EntityManager [SessionImpl(544563030<open>)] for JPA transaction
2024-08-29T21:04:53.294+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-2] o.s.orm.jpa.JpaTransactionManager        : Opened new EntityManager [SessionImpl(449363310<open>)] for JPA transaction
2024-08-29T21:04:53.295+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-1] o.s.orm.jpa.JpaTransactionManager        : Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@6e642117]
2024-08-29T21:04:53.295+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-3] o.s.orm.jpa.JpaTransactionManager        : Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@2eb2b528]
2024-08-29T21:04:53.295+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-2] o.s.orm.jpa.JpaTransactionManager        : Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@5fca2053]
2024-08-29T21:04:53.296+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-3] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(544563030<open>)] for JPA transaction
2024-08-29T21:04:53.296+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-1] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(1621345139<open>)] for JPA transaction
2024-08-29T21:04:53.296+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-2] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(449363310<open>)] for JPA transaction
2024-08-29T21:04:53.296+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-3] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.296+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-1] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.296+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-2] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.296+09:00 TRACE 42267 --- [wallet-service] [pool-3-thread-1] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.296+09:00 TRACE 42267 --- [wallet-service] [pool-3-thread-3] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.296+09:00 TRACE 42267 --- [wallet-service] [pool-3-thread-2] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
2024-08-29T21:04:53.301+09:00 TRACE 42267 --- [wallet-service] [pool-3-thread-2] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.301+09:00 TRACE 42267 --- [wallet-service] [pool-3-thread-1] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.301+09:00 TRACE 42267 --- [wallet-service] [pool-3-thread-3] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.302+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-2] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(449363310<open>)] for JPA transaction
2024-08-29T21:04:53.302+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-3] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(544563030<open>)] for JPA transaction
2024-08-29T21:04:53.302+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-3] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.302+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-1] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(1621345139<open>)] for JPA transaction
2024-08-29T21:04:53.302+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-2] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.302+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-1] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.302+09:00 TRACE 42267 --- [wallet-service] [pool-3-thread-2] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:53.302+09:00 TRACE 42267 --- [wallet-service] [pool-3-thread-3] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:53.302+09:00 TRACE 42267 --- [wallet-service] [pool-3-thread-1] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:53.302+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-2] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(449363310<open>)] for JPA transaction
2024-08-29T21:04:53.302+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-1] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(1621345139<open>)] for JPA transaction
2024-08-29T21:04:53.302+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-2] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.302+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-1] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.302+09:00 TRACE 42267 --- [wallet-service] [pool-3-thread-2] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.302+09:00 TRACE 42267 --- [wallet-service] [pool-3-thread-1] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.302+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-3] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(544563030<open>)] for JPA transaction
2024-08-29T21:04:53.302+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-3] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.303+09:00 TRACE 42267 --- [wallet-service] [pool-3-thread-3] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
2024-08-29T21:04:53.308+09:00 TRACE 42267 --- [wallet-service] [pool-3-thread-2] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.308+09:00 TRACE 42267 --- [wallet-service] [pool-3-thread-3] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.308+09:00 TRACE 42267 --- [wallet-service] [pool-3-thread-1] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.309+09:00 TRACE 42267 --- [wallet-service] [pool-3-thread-2] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:53.309+09:00 TRACE 42267 --- [wallet-service] [pool-3-thread-1] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:53.309+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-2] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction commit
2024-08-29T21:04:53.309+09:00 TRACE 42267 --- [wallet-service] [pool-3-thread-3] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:53.309+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-1] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction commit
2024-08-29T21:04:53.309+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-2] o.s.orm.jpa.JpaTransactionManager        : Committing JPA transaction on EntityManager [SessionImpl(449363310<open>)]
2024-08-29T21:04:53.309+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-3] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction commit
2024-08-29T21:04:53.309+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-1] o.s.orm.jpa.JpaTransactionManager        : Committing JPA transaction on EntityManager [SessionImpl(1621345139<open>)]
2024-08-29T21:04:53.309+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-3] o.s.orm.jpa.JpaTransactionManager        : Committing JPA transaction on EntityManager [SessionImpl(544563030<open>)]
Hibernate: 
    update
        wallets 
    set
        balance=?,
        user_id=?,
        version=? 
    where
        id=? 
        and version=?
Hibernate: 
    update
        wallets 
    set
        balance=?,
        user_id=?,
        version=? 
    where
        id=? 
        and version=?
Hibernate: 
    update
        wallets 
    set
        balance=?,
        user_id=?,
        version=? 
    where
        id=? 
        and version=?
Hibernate: 
    update
        wallets 
    set
        balance=?,
        user_id=?,
        version=? 
    where
        id=? 
        and version=?
2024-08-29T21:04:53.319+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-2] o.s.orm.jpa.JpaTransactionManager        : Closing JPA EntityManager [SessionImpl(449363310<open>)] after transaction
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
2024-08-29T21:04:53.323+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-3] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction rollback after commit exception

org.springframework.orm.ObjectOptimisticLockingFailureException: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect) : [org.example.walletservice.wallet.adapter.out.persistence.entity.JpaWalletEntity#36]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:325) ~[spring-orm-6.1.12.jar:6.1.12]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:244) ~[spring-orm-6.1.12.jar:6.1.12]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:566) ~[spring-orm-6.1.12.jar:6.1.12]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:795) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:152) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepository.performSaveOperation(JpaWalletRepository.kt:37) ~[main/:na]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepository.save(JpaWalletRepository.kt:29) ~[main/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:355) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:768) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:768) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:720) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepository$$SpringCGLIB$$0.save(<generated>) ~[main/:na]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepositoryTest.should_update_the_balance_of_wallet_successfully_when_execute_the_updated_command_at_the_same_time$lambda$2(JpaWalletRepositoryTest.kt:89) ~[test/:na]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]
Caused by: org.hibernate.StaleObjectStateException: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect) : [org.example.walletservice.wallet.adapter.out.persistence.entity.JpaWalletEntity#36]
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.identifiedResultsCheck(ModelMutationHelper.java:75) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.lambda$doStaticUpdate$8(UpdateCoordinatorStandard.java:782) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.checkResults(ModelMutationHelper.java:50) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:115) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:40) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:52) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.doStaticUpdate(UpdateCoordinatorStandard.java:778) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.performUpdate(UpdateCoordinatorStandard.java:324) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.coordinateUpdate(UpdateCoordinatorStandard.java:242) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.AbstractEntityPersister.update(AbstractEntityPersister.java:2804) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.action.internal.EntityUpdateAction.execute(EntityUpdateAction.java:168) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:632) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:499) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:377) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:41) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1407) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:488) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2329) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1986) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:562) ~[spring-orm-6.1.12.jar:6.1.12]
	... 24 common frames omitted

2024-08-29T21:04:53.325+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-3] o.s.orm.jpa.JpaTransactionManager        : Rolling back JPA transaction on EntityManager [SessionImpl(544563030<open>)]
2024-08-29T21:04:53.325+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-3] o.s.orm.jpa.JpaTransactionManager        : Closing JPA EntityManager [SessionImpl(544563030<open>)] after transaction
2024-08-29T21:04:53.325+09:00 TRACE 42267 --- [wallet-service] [pool-3-thread-3] o.s.t.i.TransactionInterceptor           : No need to create transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.findByIdIn]: This method is not transactional.
2024-08-29T21:04:53.325+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-3] tor$SharedEntityManagerInvocationHandler : Creating new EntityManager for shared EntityManager invocation
2024-08-29T21:04:53.325+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-1] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction rollback after commit exception

org.springframework.orm.ObjectOptimisticLockingFailureException: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect) : [org.example.walletservice.wallet.adapter.out.persistence.entity.JpaWalletEntity#36]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:325) ~[spring-orm-6.1.12.jar:6.1.12]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:244) ~[spring-orm-6.1.12.jar:6.1.12]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:566) ~[spring-orm-6.1.12.jar:6.1.12]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:795) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:152) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepository.performSaveOperation(JpaWalletRepository.kt:37) ~[main/:na]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepository.save(JpaWalletRepository.kt:29) ~[main/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:355) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:768) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:768) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:720) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepository$$SpringCGLIB$$0.save(<generated>) ~[main/:na]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepositoryTest.should_update_the_balance_of_wallet_successfully_when_execute_the_updated_command_at_the_same_time$lambda$0(JpaWalletRepositoryTest.kt:87) ~[test/:na]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]
Caused by: org.hibernate.StaleObjectStateException: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect) : [org.example.walletservice.wallet.adapter.out.persistence.entity.JpaWalletEntity#36]
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.identifiedResultsCheck(ModelMutationHelper.java:75) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.lambda$doStaticUpdate$8(UpdateCoordinatorStandard.java:782) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.checkResults(ModelMutationHelper.java:50) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:115) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:40) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:52) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.doStaticUpdate(UpdateCoordinatorStandard.java:778) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.performUpdate(UpdateCoordinatorStandard.java:324) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.coordinateUpdate(UpdateCoordinatorStandard.java:242) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.AbstractEntityPersister.update(AbstractEntityPersister.java:2804) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.action.internal.EntityUpdateAction.execute(EntityUpdateAction.java:168) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:632) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:499) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:377) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:41) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1407) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:488) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2329) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1986) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:562) ~[spring-orm-6.1.12.jar:6.1.12]
	... 24 common frames omitted

2024-08-29T21:04:53.326+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-1] o.s.orm.jpa.JpaTransactionManager        : Rolling back JPA transaction on EntityManager [SessionImpl(1621345139<open>)]
2024-08-29T21:04:53.326+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-1] o.s.orm.jpa.JpaTransactionManager        : Closing JPA EntityManager [SessionImpl(1621345139<open>)] after transaction
2024-08-29T21:04:53.326+09:00 TRACE 42267 --- [wallet-service] [pool-3-thread-1] o.s.t.i.TransactionInterceptor           : No need to create transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.findByIdIn]: This method is not transactional.
2024-08-29T21:04:53.326+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-1] tor$SharedEntityManagerInvocationHandler : Creating new EntityManager for shared EntityManager invocation
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id in (?, ?)
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id in (?, ?)
2024-08-29T21:04:53.329+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-3] o.s.orm.jpa.JpaTransactionManager        : Creating new transaction with name [null]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT
2024-08-29T21:04:53.330+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-3] o.s.orm.jpa.JpaTransactionManager        : Opened new EntityManager [SessionImpl(857394607<open>)] for JPA transaction
2024-08-29T21:04:53.330+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-1] o.s.orm.jpa.JpaTransactionManager        : Creating new transaction with name [null]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT
2024-08-29T21:04:53.330+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-1] o.s.orm.jpa.JpaTransactionManager        : Opened new EntityManager [SessionImpl(1124240759<open>)] for JPA transaction
2024-08-29T21:04:53.331+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-3] o.s.orm.jpa.JpaTransactionManager        : Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@567425c4]
2024-08-29T21:04:53.331+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-1] o.s.orm.jpa.JpaTransactionManager        : Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@15f48e32]
2024-08-29T21:04:53.331+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-3] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(857394607<open>)] for JPA transaction
2024-08-29T21:04:53.331+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-1] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(1124240759<open>)] for JPA transaction
2024-08-29T21:04:53.331+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-3] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.331+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-1] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.331+09:00 TRACE 42267 --- [wallet-service] [pool-3-thread-1] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.331+09:00 TRACE 42267 --- [wallet-service] [pool-3-thread-3] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
2024-08-29T21:04:53.336+09:00 TRACE 42267 --- [wallet-service] [pool-3-thread-1] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.336+09:00 TRACE 42267 --- [wallet-service] [pool-3-thread-3] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.336+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-1] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(1124240759<open>)] for JPA transaction
2024-08-29T21:04:53.336+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-3] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(857394607<open>)] for JPA transaction
2024-08-29T21:04:53.336+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-1] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.336+09:00 TRACE 42267 --- [wallet-service] [pool-3-thread-1] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:53.336+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-3] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.336+09:00 TRACE 42267 --- [wallet-service] [pool-3-thread-3] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:53.336+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-1] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(1124240759<open>)] for JPA transaction
2024-08-29T21:04:53.336+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-1] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.337+09:00 TRACE 42267 --- [wallet-service] [pool-3-thread-1] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.337+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-3] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(857394607<open>)] for JPA transaction
2024-08-29T21:04:53.337+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-3] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.337+09:00 TRACE 42267 --- [wallet-service] [pool-3-thread-3] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
2024-08-29T21:04:53.342+09:00 TRACE 42267 --- [wallet-service] [pool-3-thread-3] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.342+09:00 TRACE 42267 --- [wallet-service] [pool-3-thread-1] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.343+09:00 TRACE 42267 --- [wallet-service] [pool-3-thread-3] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:53.343+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-3] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction commit
2024-08-29T21:04:53.343+09:00 TRACE 42267 --- [wallet-service] [pool-3-thread-1] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:53.343+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-3] o.s.orm.jpa.JpaTransactionManager        : Committing JPA transaction on EntityManager [SessionImpl(857394607<open>)]
2024-08-29T21:04:53.343+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-1] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction commit
2024-08-29T21:04:53.343+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-1] o.s.orm.jpa.JpaTransactionManager        : Committing JPA transaction on EntityManager [SessionImpl(1124240759<open>)]
Hibernate: 
    update
        wallets 
    set
        balance=?,
        user_id=?,
        version=? 
    where
        id=? 
        and version=?
Hibernate: 
    update
        wallets 
    set
        balance=?,
        user_id=?,
        version=? 
    where
        id=? 
        and version=?
Hibernate: 
    update
        wallets 
    set
        balance=?,
        user_id=?,
        version=? 
    where
        id=? 
        and version=?
2024-08-29T21:04:53.351+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-3] o.s.orm.jpa.JpaTransactionManager        : Closing JPA EntityManager [SessionImpl(857394607<open>)] after transaction
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
2024-08-29T21:04:53.355+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-1] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction rollback after commit exception

org.springframework.orm.ObjectOptimisticLockingFailureException: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect) : [org.example.walletservice.wallet.adapter.out.persistence.entity.JpaWalletEntity#36]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:325) ~[spring-orm-6.1.12.jar:6.1.12]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:244) ~[spring-orm-6.1.12.jar:6.1.12]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:566) ~[spring-orm-6.1.12.jar:6.1.12]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:795) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:152) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepository.performSaveOperationWithRecent(JpaWalletRepository.kt:69) ~[main/:na]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepository.retrySaveOperation(JpaWalletRepository.kt:48) ~[main/:na]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepository.retrySaveOperation$default(JpaWalletRepository.kt:43) ~[main/:na]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepository.save(JpaWalletRepository.kt:31) ~[main/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:355) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:768) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:768) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:720) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepository$$SpringCGLIB$$0.save(<generated>) ~[main/:na]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepositoryTest.should_update_the_balance_of_wallet_successfully_when_execute_the_updated_command_at_the_same_time$lambda$0(JpaWalletRepositoryTest.kt:87) ~[test/:na]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]
Caused by: org.hibernate.StaleObjectStateException: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect) : [org.example.walletservice.wallet.adapter.out.persistence.entity.JpaWalletEntity#36]
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.identifiedResultsCheck(ModelMutationHelper.java:75) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.lambda$doStaticUpdate$8(UpdateCoordinatorStandard.java:782) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.checkResults(ModelMutationHelper.java:50) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:115) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:40) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:52) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.doStaticUpdate(UpdateCoordinatorStandard.java:778) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.performUpdate(UpdateCoordinatorStandard.java:324) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.coordinateUpdate(UpdateCoordinatorStandard.java:242) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.AbstractEntityPersister.update(AbstractEntityPersister.java:2804) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.action.internal.EntityUpdateAction.execute(EntityUpdateAction.java:168) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:632) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:499) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:377) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:41) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1407) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:488) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2329) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1986) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:562) ~[spring-orm-6.1.12.jar:6.1.12]
	... 26 common frames omitted

2024-08-29T21:04:53.356+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-1] o.s.orm.jpa.JpaTransactionManager        : Rolling back JPA transaction on EntityManager [SessionImpl(1124240759<open>)]
2024-08-29T21:04:53.356+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-1] o.s.orm.jpa.JpaTransactionManager        : Closing JPA EntityManager [SessionImpl(1124240759<open>)] after transaction
2024-08-29T21:04:53.454+09:00 TRACE 42267 --- [wallet-service] [pool-3-thread-1] o.s.t.i.TransactionInterceptor           : No need to create transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.findByIdIn]: This method is not transactional.
2024-08-29T21:04:53.454+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-1] tor$SharedEntityManagerInvocationHandler : Creating new EntityManager for shared EntityManager invocation
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id in (?, ?)
2024-08-29T21:04:53.457+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-1] o.s.orm.jpa.JpaTransactionManager        : Creating new transaction with name [null]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT
2024-08-29T21:04:53.457+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-1] o.s.orm.jpa.JpaTransactionManager        : Opened new EntityManager [SessionImpl(874743460<open>)] for JPA transaction
2024-08-29T21:04:53.458+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-1] o.s.orm.jpa.JpaTransactionManager        : Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@81b6a18]
2024-08-29T21:04:53.458+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-1] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(874743460<open>)] for JPA transaction
2024-08-29T21:04:53.458+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-1] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.458+09:00 TRACE 42267 --- [wallet-service] [pool-3-thread-1] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
2024-08-29T21:04:53.462+09:00 TRACE 42267 --- [wallet-service] [pool-3-thread-1] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.462+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-1] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(874743460<open>)] for JPA transaction
2024-08-29T21:04:53.462+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-1] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.462+09:00 TRACE 42267 --- [wallet-service] [pool-3-thread-1] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:53.462+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-1] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(874743460<open>)] for JPA transaction
2024-08-29T21:04:53.462+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-1] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.462+09:00 TRACE 42267 --- [wallet-service] [pool-3-thread-1] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
2024-08-29T21:04:53.466+09:00 TRACE 42267 --- [wallet-service] [pool-3-thread-1] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.466+09:00 TRACE 42267 --- [wallet-service] [pool-3-thread-1] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:53.466+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-1] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction commit
2024-08-29T21:04:53.466+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-1] o.s.orm.jpa.JpaTransactionManager        : Committing JPA transaction on EntityManager [SessionImpl(874743460<open>)]
Hibernate: 
    update
        wallets 
    set
        balance=?,
        user_id=?,
        version=? 
    where
        id=? 
        and version=?
Hibernate: 
    update
        wallets 
    set
        balance=?,
        user_id=?,
        version=? 
    where
        id=? 
        and version=?
2024-08-29T21:04:53.473+09:00 DEBUG 42267 --- [wallet-service] [pool-3-thread-1] o.s.orm.jpa.JpaTransactionManager        : Closing JPA EntityManager [SessionImpl(874743460<open>)] after transaction
2024-08-29T21:04:53.473+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Creating new transaction with name [org.springframework.data.jpa.repository.support.SimpleJpaRepository.findById]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT,readOnly
2024-08-29T21:04:53.473+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Opened new EntityManager [SessionImpl(1625763053<open>)] for JPA transaction
2024-08-29T21:04:53.474+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@3d376f28]
2024-08-29T21:04:53.474+09:00 TRACE 42267 --- [wallet-service] [    Test worker] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.findById]
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
2024-08-29T21:04:53.476+09:00 TRACE 42267 --- [wallet-service] [    Test worker] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.findById]
2024-08-29T21:04:53.476+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction commit
2024-08-29T21:04:53.476+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Committing JPA transaction on EntityManager [SessionImpl(1625763053<open>)]
2024-08-29T21:04:53.478+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Closing JPA EntityManager [SessionImpl(1625763053<open>)] after transaction
2024-08-29T21:04:53.478+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Creating new transaction with name [org.springframework.data.jpa.repository.support.SimpleJpaRepository.findById]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT,readOnly
2024-08-29T21:04:53.478+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Opened new EntityManager [SessionImpl(1914682082<open>)] for JPA transaction
2024-08-29T21:04:53.479+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@130f8e03]
2024-08-29T21:04:53.479+09:00 TRACE 42267 --- [wallet-service] [    Test worker] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.findById]
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
2024-08-29T21:04:53.481+09:00 TRACE 42267 --- [wallet-service] [    Test worker] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.findById]
2024-08-29T21:04:53.481+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction commit
2024-08-29T21:04:53.481+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Committing JPA transaction on EntityManager [SessionImpl(1914682082<open>)]
2024-08-29T21:04:53.482+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Closing JPA EntityManager [SessionImpl(1914682082<open>)] after transaction
2024-08-29T21:04:53.488+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Creating new transaction with name [org.springframework.data.jpa.repository.support.SimpleJpaRepository.deleteAll]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT
2024-08-29T21:04:53.489+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Opened new EntityManager [SessionImpl(2107886571<open>)] for JPA transaction
2024-08-29T21:04:53.490+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@5e396d2c]
2024-08-29T21:04:53.490+09:00 TRACE 42267 --- [wallet-service] [    Test worker] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.deleteAll]
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0
2024-08-29T21:04:53.493+09:00 TRACE 42267 --- [wallet-service] [    Test worker] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.deleteAll]
2024-08-29T21:04:53.493+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction commit
2024-08-29T21:04:53.493+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Committing JPA transaction on EntityManager [SessionImpl(2107886571<open>)]
Hibernate: 
    delete 
    from
        wallets 
    where
        id=? 
        and version=?
Hibernate: 
    delete 
    from
        wallets 
    where
        id=? 
        and version=?
2024-08-29T21:04:53.501+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Closing JPA EntityManager [SessionImpl(2107886571<open>)] after transaction
2024-08-29T21:04:53.501+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Creating new transaction with name [org.springframework.data.jpa.repository.support.SimpleJpaRepository.deleteAll]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT
2024-08-29T21:04:53.502+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Opened new EntityManager [SessionImpl(1597561973<open>)] for JPA transaction
2024-08-29T21:04:53.502+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@48e0d3a7]
2024-08-29T21:04:53.502+09:00 TRACE 42267 --- [wallet-service] [    Test worker] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.deleteAll]
Hibernate: 
    select
        jwte1_0.id,
        jwte1_0.amount,
        jwte1_0.idempotency_key,
        jwte1_0.order_id,
        jwte1_0.reference_id,
        jwte1_0.reference_type,
        jwte1_0.type,
        jwte1_0.wallet_id 
    from
        wallet_transactions jwte1_0
2024-08-29T21:04:53.506+09:00 TRACE 42267 --- [wallet-service] [    Test worker] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.deleteAll]
2024-08-29T21:04:53.506+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction commit
2024-08-29T21:04:53.506+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Committing JPA transaction on EntityManager [SessionImpl(1597561973<open>)]
Hibernate: 
    delete 
    from
        wallet_transactions 
    where
        id=?
Hibernate: 
    delete 
    from
        wallet_transactions 
    where
        id=?
Hibernate: 
    delete 
    from
        wallet_transactions 
    where
        id=?
Hibernate: 
    delete 
    from
        wallet_transactions 
    where
        id=?
Hibernate: 
    delete 
    from
        wallet_transactions 
    where
        id=?
Hibernate: 
    delete 
    from
        wallet_transactions 
    where
        id=?
2024-08-29T21:04:53.519+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Closing JPA EntityManager [SessionImpl(1597561973<open>)] after transaction
2024-08-29T21:04:53.519+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Creating new transaction with name [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT
2024-08-29T21:04:53.519+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Opened new EntityManager [SessionImpl(1245639881<open>)] for JPA transaction
2024-08-29T21:04:53.520+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@6fc26fb1]
2024-08-29T21:04:53.521+09:00 TRACE 42267 --- [wallet-service] [    Test worker] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
Hibernate: 
    insert 
    into
        wallets
        (balance, user_id, version) 
    values
        (?, ?, ?)
Hibernate: 
    insert 
    into
        wallets
        (balance, user_id, version) 
    values
        (?, ?, ?)
2024-08-29T21:04:53.525+09:00 TRACE 42267 --- [wallet-service] [    Test worker] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.525+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction commit
2024-08-29T21:04:53.525+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Committing JPA transaction on EntityManager [SessionImpl(1245639881<open>)]
2024-08-29T21:04:53.529+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Closing JPA EntityManager [SessionImpl(1245639881<open>)] after transaction
2024-08-29T21:04:53.530+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-1] o.s.orm.jpa.JpaTransactionManager        : Creating new transaction with name [null]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT
2024-08-29T21:04:53.530+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-2] o.s.orm.jpa.JpaTransactionManager        : Creating new transaction with name [null]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT
2024-08-29T21:04:53.530+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-3] o.s.orm.jpa.JpaTransactionManager        : Creating new transaction with name [null]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT
2024-08-29T21:04:53.530+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-1] o.s.orm.jpa.JpaTransactionManager        : Opened new EntityManager [SessionImpl(1057279924<open>)] for JPA transaction
2024-08-29T21:04:53.530+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-2] o.s.orm.jpa.JpaTransactionManager        : Opened new EntityManager [SessionImpl(185767070<open>)] for JPA transaction
2024-08-29T21:04:53.531+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-3] o.s.orm.jpa.JpaTransactionManager        : Opened new EntityManager [SessionImpl(1532412480<open>)] for JPA transaction
2024-08-29T21:04:53.532+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-2] o.s.orm.jpa.JpaTransactionManager        : Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@5d56b8c]
2024-08-29T21:04:53.532+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-1] o.s.orm.jpa.JpaTransactionManager        : Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@31c33624]
2024-08-29T21:04:53.532+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-3] o.s.orm.jpa.JpaTransactionManager        : Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@5591375a]
2024-08-29T21:04:53.532+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-2] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(185767070<open>)] for JPA transaction
2024-08-29T21:04:53.532+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-2] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.532+09:00 TRACE 42267 --- [wallet-service] [pool-4-thread-2] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.532+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-3] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(1532412480<open>)] for JPA transaction
2024-08-29T21:04:53.532+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-1] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(1057279924<open>)] for JPA transaction
2024-08-29T21:04:53.532+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-3] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.532+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-1] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.532+09:00 TRACE 42267 --- [wallet-service] [pool-4-thread-1] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.532+09:00 TRACE 42267 --- [wallet-service] [pool-4-thread-3] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
2024-08-29T21:04:53.537+09:00 TRACE 42267 --- [wallet-service] [pool-4-thread-3] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.537+09:00 TRACE 42267 --- [wallet-service] [pool-4-thread-2] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.537+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-3] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(1532412480<open>)] for JPA transaction
2024-08-29T21:04:53.537+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-3] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.537+09:00 TRACE 42267 --- [wallet-service] [pool-4-thread-1] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.537+09:00 TRACE 42267 --- [wallet-service] [pool-4-thread-3] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:53.537+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-2] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(185767070<open>)] for JPA transaction
2024-08-29T21:04:53.537+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-2] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.537+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-1] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(1057279924<open>)] for JPA transaction
2024-08-29T21:04:53.537+09:00 TRACE 42267 --- [wallet-service] [pool-4-thread-2] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:53.537+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-1] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.537+09:00 TRACE 42267 --- [wallet-service] [pool-4-thread-1] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:53.537+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-3] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(1532412480<open>)] for JPA transaction
2024-08-29T21:04:53.537+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-3] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.537+09:00 TRACE 42267 --- [wallet-service] [pool-4-thread-3] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.537+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-2] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(185767070<open>)] for JPA transaction
2024-08-29T21:04:53.538+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-2] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.538+09:00 TRACE 42267 --- [wallet-service] [pool-4-thread-2] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.538+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-1] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(1057279924<open>)] for JPA transaction
2024-08-29T21:04:53.538+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-1] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.538+09:00 TRACE 42267 --- [wallet-service] [pool-4-thread-1] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
2024-08-29T21:04:53.542+09:00 TRACE 42267 --- [wallet-service] [pool-4-thread-1] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.543+09:00 TRACE 42267 --- [wallet-service] [pool-4-thread-2] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.543+09:00 TRACE 42267 --- [wallet-service] [pool-4-thread-1] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:53.542+09:00 TRACE 42267 --- [wallet-service] [pool-4-thread-3] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.543+09:00 TRACE 42267 --- [wallet-service] [pool-4-thread-2] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:53.543+09:00 TRACE 42267 --- [wallet-service] [pool-4-thread-3] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:53.543+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-1] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction commit
2024-08-29T21:04:53.543+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-2] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction commit
2024-08-29T21:04:53.543+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-3] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction commit
2024-08-29T21:04:53.543+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-1] o.s.orm.jpa.JpaTransactionManager        : Committing JPA transaction on EntityManager [SessionImpl(1057279924<open>)]
2024-08-29T21:04:53.543+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-3] o.s.orm.jpa.JpaTransactionManager        : Committing JPA transaction on EntityManager [SessionImpl(1532412480<open>)]
2024-08-29T21:04:53.543+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-2] o.s.orm.jpa.JpaTransactionManager        : Committing JPA transaction on EntityManager [SessionImpl(185767070<open>)]
Hibernate: 
    update
        wallets 
    set
        balance=?,
        user_id=?,
        version=? 
    where
        id=? 
        and version=?
Hibernate: 
    update
        wallets 
    set
        balance=?,
        user_id=?,
        version=? 
    where
        id=? 
        and version=?
Hibernate: 
    update
        wallets 
    set
        balance=?,
        user_id=?,
        version=? 
    where
        id=? 
        and version=?
Hibernate: 
    update
        wallets 
    set
        balance=?,
        user_id=?,
        version=? 
    where
        id=? 
        and version=?
2024-08-29T21:04:53.553+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-2] o.s.orm.jpa.JpaTransactionManager        : Closing JPA EntityManager [SessionImpl(185767070<open>)] after transaction
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
2024-08-29T21:04:53.557+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-3] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction rollback after commit exception

org.springframework.orm.ObjectOptimisticLockingFailureException: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect) : [org.example.walletservice.wallet.adapter.out.persistence.entity.JpaWalletEntity#38]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:325) ~[spring-orm-6.1.12.jar:6.1.12]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:244) ~[spring-orm-6.1.12.jar:6.1.12]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:566) ~[spring-orm-6.1.12.jar:6.1.12]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:795) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:152) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepository.performSaveOperation(JpaWalletRepository.kt:37) ~[main/:na]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepository.save(JpaWalletRepository.kt:29) ~[main/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:355) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:768) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:768) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:720) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepository$$SpringCGLIB$$0.save(<generated>) ~[main/:na]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepositoryTest.should_update_the_balance_of_wallet_successfully_when_execute_the_updated_command_at_the_same_time$lambda$2(JpaWalletRepositoryTest.kt:89) ~[test/:na]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]
Caused by: org.hibernate.StaleObjectStateException: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect) : [org.example.walletservice.wallet.adapter.out.persistence.entity.JpaWalletEntity#38]
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.identifiedResultsCheck(ModelMutationHelper.java:75) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.lambda$doStaticUpdate$8(UpdateCoordinatorStandard.java:782) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.checkResults(ModelMutationHelper.java:50) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:115) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:40) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:52) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.doStaticUpdate(UpdateCoordinatorStandard.java:778) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.performUpdate(UpdateCoordinatorStandard.java:324) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.coordinateUpdate(UpdateCoordinatorStandard.java:242) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.AbstractEntityPersister.update(AbstractEntityPersister.java:2804) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.action.internal.EntityUpdateAction.execute(EntityUpdateAction.java:168) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:632) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:499) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:377) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:41) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1407) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:488) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2329) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1986) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:562) ~[spring-orm-6.1.12.jar:6.1.12]
	... 24 common frames omitted

2024-08-29T21:04:53.558+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-3] o.s.orm.jpa.JpaTransactionManager        : Rolling back JPA transaction on EntityManager [SessionImpl(1532412480<open>)]
2024-08-29T21:04:53.558+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-3] o.s.orm.jpa.JpaTransactionManager        : Closing JPA EntityManager [SessionImpl(1532412480<open>)] after transaction
2024-08-29T21:04:53.558+09:00 TRACE 42267 --- [wallet-service] [pool-4-thread-3] o.s.t.i.TransactionInterceptor           : No need to create transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.findByIdIn]: This method is not transactional.
2024-08-29T21:04:53.558+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-3] tor$SharedEntityManagerInvocationHandler : Creating new EntityManager for shared EntityManager invocation
2024-08-29T21:04:53.558+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-1] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction rollback after commit exception

org.springframework.orm.ObjectOptimisticLockingFailureException: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect) : [org.example.walletservice.wallet.adapter.out.persistence.entity.JpaWalletEntity#38]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:325) ~[spring-orm-6.1.12.jar:6.1.12]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:244) ~[spring-orm-6.1.12.jar:6.1.12]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:566) ~[spring-orm-6.1.12.jar:6.1.12]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:795) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:152) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepository.performSaveOperation(JpaWalletRepository.kt:37) ~[main/:na]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepository.save(JpaWalletRepository.kt:29) ~[main/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:355) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:768) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:768) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:720) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepository$$SpringCGLIB$$0.save(<generated>) ~[main/:na]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepositoryTest.should_update_the_balance_of_wallet_successfully_when_execute_the_updated_command_at_the_same_time$lambda$0(JpaWalletRepositoryTest.kt:87) ~[test/:na]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]
Caused by: org.hibernate.StaleObjectStateException: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect) : [org.example.walletservice.wallet.adapter.out.persistence.entity.JpaWalletEntity#38]
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.identifiedResultsCheck(ModelMutationHelper.java:75) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.lambda$doStaticUpdate$8(UpdateCoordinatorStandard.java:782) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.checkResults(ModelMutationHelper.java:50) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:115) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:40) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:52) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.doStaticUpdate(UpdateCoordinatorStandard.java:778) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.performUpdate(UpdateCoordinatorStandard.java:324) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.coordinateUpdate(UpdateCoordinatorStandard.java:242) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.AbstractEntityPersister.update(AbstractEntityPersister.java:2804) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.action.internal.EntityUpdateAction.execute(EntityUpdateAction.java:168) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:632) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:499) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:377) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:41) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1407) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:488) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2329) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1986) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:562) ~[spring-orm-6.1.12.jar:6.1.12]
	... 24 common frames omitted

2024-08-29T21:04:53.559+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-1] o.s.orm.jpa.JpaTransactionManager        : Rolling back JPA transaction on EntityManager [SessionImpl(1057279924<open>)]
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
2024-08-29T21:04:53.560+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-1] o.s.orm.jpa.JpaTransactionManager        : Closing JPA EntityManager [SessionImpl(1057279924<open>)] after transaction
        jwe1_0.id in (?, ?)
2024-08-29T21:04:53.560+09:00 TRACE 42267 --- [wallet-service] [pool-4-thread-1] o.s.t.i.TransactionInterceptor           : No need to create transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.findByIdIn]: This method is not transactional.
2024-08-29T21:04:53.560+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-1] tor$SharedEntityManagerInvocationHandler : Creating new EntityManager for shared EntityManager invocation
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id in (?, ?)
2024-08-29T21:04:53.562+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-3] o.s.orm.jpa.JpaTransactionManager        : Creating new transaction with name [null]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT
2024-08-29T21:04:53.562+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-3] o.s.orm.jpa.JpaTransactionManager        : Opened new EntityManager [SessionImpl(218803281<open>)] for JPA transaction
2024-08-29T21:04:53.563+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-3] o.s.orm.jpa.JpaTransactionManager        : Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@6048802a]
2024-08-29T21:04:53.564+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-3] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(218803281<open>)] for JPA transaction
2024-08-29T21:04:53.564+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-3] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.564+09:00 TRACE 42267 --- [wallet-service] [pool-4-thread-3] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.564+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-1] o.s.orm.jpa.JpaTransactionManager        : Creating new transaction with name [null]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT
2024-08-29T21:04:53.564+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-1] o.s.orm.jpa.JpaTransactionManager        : Opened new EntityManager [SessionImpl(524051194<open>)] for JPA transaction
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
2024-08-29T21:04:53.565+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-1] o.s.orm.jpa.JpaTransactionManager        : Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@6a036129]
2024-08-29T21:04:53.566+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-1] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(524051194<open>)] for JPA transaction
2024-08-29T21:04:53.566+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-1] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.566+09:00 TRACE 42267 --- [wallet-service] [pool-4-thread-1] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
2024-08-29T21:04:53.568+09:00 TRACE 42267 --- [wallet-service] [pool-4-thread-3] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.568+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-3] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(218803281<open>)] for JPA transaction
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
2024-08-29T21:04:53.568+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-3] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.568+09:00 TRACE 42267 --- [wallet-service] [pool-4-thread-3] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:53.569+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-3] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(218803281<open>)] for JPA transaction
2024-08-29T21:04:53.569+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-3] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.569+09:00 TRACE 42267 --- [wallet-service] [pool-4-thread-3] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
2024-08-29T21:04:53.570+09:00 TRACE 42267 --- [wallet-service] [pool-4-thread-1] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.570+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-1] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(524051194<open>)] for JPA transaction
2024-08-29T21:04:53.570+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-1] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.570+09:00 TRACE 42267 --- [wallet-service] [pool-4-thread-1] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:53.570+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-1] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(524051194<open>)] for JPA transaction
2024-08-29T21:04:53.571+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-1] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.571+09:00 TRACE 42267 --- [wallet-service] [pool-4-thread-1] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
2024-08-29T21:04:53.576+09:00 TRACE 42267 --- [wallet-service] [pool-4-thread-1] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.576+09:00 TRACE 42267 --- [wallet-service] [pool-4-thread-3] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.576+09:00 TRACE 42267 --- [wallet-service] [pool-4-thread-1] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:53.576+09:00 TRACE 42267 --- [wallet-service] [pool-4-thread-3] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:53.576+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-1] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction commit
2024-08-29T21:04:53.576+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-3] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction commit
2024-08-29T21:04:53.576+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-1] o.s.orm.jpa.JpaTransactionManager        : Committing JPA transaction on EntityManager [SessionImpl(524051194<open>)]
2024-08-29T21:04:53.576+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-3] o.s.orm.jpa.JpaTransactionManager        : Committing JPA transaction on EntityManager [SessionImpl(218803281<open>)]
Hibernate: 
    update
        wallets 
    set
        balance=?,
        user_id=?,
        version=? 
    where
        id=? 
        and version=?
Hibernate: 
    update
        wallets 
    set
        balance=?,
        user_id=?,
        version=? 
    where
        id=? 
        and version=?
Hibernate: 
    update
        wallets 
    set
        balance=?,
        user_id=?,
        version=? 
    where
        id=? 
        and version=?
2024-08-29T21:04:53.584+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-3] o.s.orm.jpa.JpaTransactionManager        : Closing JPA EntityManager [SessionImpl(218803281<open>)] after transaction
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
2024-08-29T21:04:53.589+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-1] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction rollback after commit exception

org.springframework.orm.ObjectOptimisticLockingFailureException: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect) : [org.example.walletservice.wallet.adapter.out.persistence.entity.JpaWalletEntity#38]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:325) ~[spring-orm-6.1.12.jar:6.1.12]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:244) ~[spring-orm-6.1.12.jar:6.1.12]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:566) ~[spring-orm-6.1.12.jar:6.1.12]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:795) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:152) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepository.performSaveOperationWithRecent(JpaWalletRepository.kt:69) ~[main/:na]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepository.retrySaveOperation(JpaWalletRepository.kt:48) ~[main/:na]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepository.retrySaveOperation$default(JpaWalletRepository.kt:43) ~[main/:na]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepository.save(JpaWalletRepository.kt:31) ~[main/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:355) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:768) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:768) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:720) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepository$$SpringCGLIB$$0.save(<generated>) ~[main/:na]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepositoryTest.should_update_the_balance_of_wallet_successfully_when_execute_the_updated_command_at_the_same_time$lambda$0(JpaWalletRepositoryTest.kt:87) ~[test/:na]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]
Caused by: org.hibernate.StaleObjectStateException: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect) : [org.example.walletservice.wallet.adapter.out.persistence.entity.JpaWalletEntity#38]
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.identifiedResultsCheck(ModelMutationHelper.java:75) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.lambda$doStaticUpdate$8(UpdateCoordinatorStandard.java:782) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.checkResults(ModelMutationHelper.java:50) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:115) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:40) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:52) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.doStaticUpdate(UpdateCoordinatorStandard.java:778) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.performUpdate(UpdateCoordinatorStandard.java:324) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.coordinateUpdate(UpdateCoordinatorStandard.java:242) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.AbstractEntityPersister.update(AbstractEntityPersister.java:2804) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.action.internal.EntityUpdateAction.execute(EntityUpdateAction.java:168) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:632) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:499) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:377) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:41) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1407) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:488) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2329) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1986) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:562) ~[spring-orm-6.1.12.jar:6.1.12]
	... 26 common frames omitted

2024-08-29T21:04:53.590+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-1] o.s.orm.jpa.JpaTransactionManager        : Rolling back JPA transaction on EntityManager [SessionImpl(524051194<open>)]
2024-08-29T21:04:53.590+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-1] o.s.orm.jpa.JpaTransactionManager        : Closing JPA EntityManager [SessionImpl(524051194<open>)] after transaction
2024-08-29T21:04:53.611+09:00 TRACE 42267 --- [wallet-service] [pool-4-thread-1] o.s.t.i.TransactionInterceptor           : No need to create transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.findByIdIn]: This method is not transactional.
2024-08-29T21:04:53.611+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-1] tor$SharedEntityManagerInvocationHandler : Creating new EntityManager for shared EntityManager invocation
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id in (?, ?)
2024-08-29T21:04:53.614+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-1] o.s.orm.jpa.JpaTransactionManager        : Creating new transaction with name [null]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT
2024-08-29T21:04:53.615+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-1] o.s.orm.jpa.JpaTransactionManager        : Opened new EntityManager [SessionImpl(1245748407<open>)] for JPA transaction
2024-08-29T21:04:53.615+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-1] o.s.orm.jpa.JpaTransactionManager        : Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@60355248]
2024-08-29T21:04:53.615+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-1] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(1245748407<open>)] for JPA transaction
2024-08-29T21:04:53.615+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-1] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.615+09:00 TRACE 42267 --- [wallet-service] [pool-4-thread-1] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
2024-08-29T21:04:53.618+09:00 TRACE 42267 --- [wallet-service] [pool-4-thread-1] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.618+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-1] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(1245748407<open>)] for JPA transaction
2024-08-29T21:04:53.618+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-1] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.618+09:00 TRACE 42267 --- [wallet-service] [pool-4-thread-1] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:53.619+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-1] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(1245748407<open>)] for JPA transaction
2024-08-29T21:04:53.619+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-1] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.619+09:00 TRACE 42267 --- [wallet-service] [pool-4-thread-1] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
2024-08-29T21:04:53.622+09:00 TRACE 42267 --- [wallet-service] [pool-4-thread-1] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.622+09:00 TRACE 42267 --- [wallet-service] [pool-4-thread-1] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:53.622+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-1] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction commit
2024-08-29T21:04:53.622+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-1] o.s.orm.jpa.JpaTransactionManager        : Committing JPA transaction on EntityManager [SessionImpl(1245748407<open>)]
Hibernate: 
    update
        wallets 
    set
        balance=?,
        user_id=?,
        version=? 
    where
        id=? 
        and version=?
Hibernate: 
    update
        wallets 
    set
        balance=?,
        user_id=?,
        version=? 
    where
        id=? 
        and version=?
2024-08-29T21:04:53.629+09:00 DEBUG 42267 --- [wallet-service] [pool-4-thread-1] o.s.orm.jpa.JpaTransactionManager        : Closing JPA EntityManager [SessionImpl(1245748407<open>)] after transaction
2024-08-29T21:04:53.629+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Creating new transaction with name [org.springframework.data.jpa.repository.support.SimpleJpaRepository.findById]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT,readOnly
2024-08-29T21:04:53.629+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Opened new EntityManager [SessionImpl(1367226395<open>)] for JPA transaction
2024-08-29T21:04:53.630+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@6178b3bf]
2024-08-29T21:04:53.630+09:00 TRACE 42267 --- [wallet-service] [    Test worker] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.findById]
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
2024-08-29T21:04:53.632+09:00 TRACE 42267 --- [wallet-service] [    Test worker] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.findById]
2024-08-29T21:04:53.632+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction commit
2024-08-29T21:04:53.632+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Committing JPA transaction on EntityManager [SessionImpl(1367226395<open>)]
2024-08-29T21:04:53.634+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Closing JPA EntityManager [SessionImpl(1367226395<open>)] after transaction
2024-08-29T21:04:53.634+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Creating new transaction with name [org.springframework.data.jpa.repository.support.SimpleJpaRepository.findById]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT,readOnly
2024-08-29T21:04:53.634+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Opened new EntityManager [SessionImpl(1286757203<open>)] for JPA transaction
2024-08-29T21:04:53.635+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@4e9a4142]
2024-08-29T21:04:53.635+09:00 TRACE 42267 --- [wallet-service] [    Test worker] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.findById]
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
2024-08-29T21:04:53.637+09:00 TRACE 42267 --- [wallet-service] [    Test worker] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.findById]
2024-08-29T21:04:53.637+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction commit
2024-08-29T21:04:53.637+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Committing JPA transaction on EntityManager [SessionImpl(1286757203<open>)]
2024-08-29T21:04:53.638+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Closing JPA EntityManager [SessionImpl(1286757203<open>)] after transaction
2024-08-29T21:04:53.644+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Creating new transaction with name [org.springframework.data.jpa.repository.support.SimpleJpaRepository.deleteAll]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT
2024-08-29T21:04:53.644+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Opened new EntityManager [SessionImpl(663646750<open>)] for JPA transaction
2024-08-29T21:04:53.645+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@65354578]
2024-08-29T21:04:53.645+09:00 TRACE 42267 --- [wallet-service] [    Test worker] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.deleteAll]
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0
2024-08-29T21:04:53.647+09:00 TRACE 42267 --- [wallet-service] [    Test worker] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.deleteAll]
2024-08-29T21:04:53.647+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction commit
2024-08-29T21:04:53.647+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Committing JPA transaction on EntityManager [SessionImpl(663646750<open>)]
Hibernate: 
    delete 
    from
        wallets 
    where
        id=? 
        and version=?
Hibernate: 
    delete 
    from
        wallets 
    where
        id=? 
        and version=?
2024-08-29T21:04:53.656+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Closing JPA EntityManager [SessionImpl(663646750<open>)] after transaction
2024-08-29T21:04:53.656+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Creating new transaction with name [org.springframework.data.jpa.repository.support.SimpleJpaRepository.deleteAll]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT
2024-08-29T21:04:53.656+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Opened new EntityManager [SessionImpl(1670573244<open>)] for JPA transaction
2024-08-29T21:04:53.657+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@2219d6d8]
2024-08-29T21:04:53.657+09:00 TRACE 42267 --- [wallet-service] [    Test worker] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.deleteAll]
Hibernate: 
    select
        jwte1_0.id,
        jwte1_0.amount,
        jwte1_0.idempotency_key,
        jwte1_0.order_id,
        jwte1_0.reference_id,
        jwte1_0.reference_type,
        jwte1_0.type,
        jwte1_0.wallet_id 
    from
        wallet_transactions jwte1_0
2024-08-29T21:04:53.661+09:00 TRACE 42267 --- [wallet-service] [    Test worker] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.deleteAll]
2024-08-29T21:04:53.661+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction commit
2024-08-29T21:04:53.661+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Committing JPA transaction on EntityManager [SessionImpl(1670573244<open>)]
Hibernate: 
    delete 
    from
        wallet_transactions 
    where
        id=?
Hibernate: 
    delete 
    from
        wallet_transactions 
    where
        id=?
Hibernate: 
    delete 
    from
        wallet_transactions 
    where
        id=?
Hibernate: 
    delete 
    from
        wallet_transactions 
    where
        id=?
Hibernate: 
    delete 
    from
        wallet_transactions 
    where
        id=?
Hibernate: 
    delete 
    from
        wallet_transactions 
    where
        id=?
2024-08-29T21:04:53.673+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Closing JPA EntityManager [SessionImpl(1670573244<open>)] after transaction
2024-08-29T21:04:53.674+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Creating new transaction with name [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT
2024-08-29T21:04:53.674+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Opened new EntityManager [SessionImpl(1857927480<open>)] for JPA transaction
2024-08-29T21:04:53.675+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@53e7dfc4]
2024-08-29T21:04:53.675+09:00 TRACE 42267 --- [wallet-service] [    Test worker] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
Hibernate: 
    insert 
    into
        wallets
        (balance, user_id, version) 
    values
        (?, ?, ?)
Hibernate: 
    insert 
    into
        wallets
        (balance, user_id, version) 
    values
        (?, ?, ?)
2024-08-29T21:04:53.679+09:00 TRACE 42267 --- [wallet-service] [    Test worker] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.679+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction commit
2024-08-29T21:04:53.679+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Committing JPA transaction on EntityManager [SessionImpl(1857927480<open>)]
2024-08-29T21:04:53.684+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Closing JPA EntityManager [SessionImpl(1857927480<open>)] after transaction
2024-08-29T21:04:53.685+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-1] o.s.orm.jpa.JpaTransactionManager        : Creating new transaction with name [null]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT
2024-08-29T21:04:53.685+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-2] o.s.orm.jpa.JpaTransactionManager        : Creating new transaction with name [null]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT
2024-08-29T21:04:53.685+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-1] o.s.orm.jpa.JpaTransactionManager        : Opened new EntityManager [SessionImpl(409876686<open>)] for JPA transaction
2024-08-29T21:04:53.685+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-2] o.s.orm.jpa.JpaTransactionManager        : Opened new EntityManager [SessionImpl(982976082<open>)] for JPA transaction
2024-08-29T21:04:53.685+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-3] o.s.orm.jpa.JpaTransactionManager        : Creating new transaction with name [null]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT
2024-08-29T21:04:53.685+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-3] o.s.orm.jpa.JpaTransactionManager        : Opened new EntityManager [SessionImpl(1518829076<open>)] for JPA transaction
2024-08-29T21:04:53.686+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-1] o.s.orm.jpa.JpaTransactionManager        : Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@16a9d5b3]
2024-08-29T21:04:53.686+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-3] o.s.orm.jpa.JpaTransactionManager        : Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@54409b34]
2024-08-29T21:04:53.686+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-2] o.s.orm.jpa.JpaTransactionManager        : Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@3450ff70]
2024-08-29T21:04:53.686+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-1] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(409876686<open>)] for JPA transaction
2024-08-29T21:04:53.686+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-1] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.686+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-3] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(1518829076<open>)] for JPA transaction
2024-08-29T21:04:53.686+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-2] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(982976082<open>)] for JPA transaction
2024-08-29T21:04:53.686+09:00 TRACE 42267 --- [wallet-service] [pool-5-thread-1] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.686+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-2] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.686+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-3] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.686+09:00 TRACE 42267 --- [wallet-service] [pool-5-thread-2] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.687+09:00 TRACE 42267 --- [wallet-service] [pool-5-thread-3] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
2024-08-29T21:04:53.691+09:00 TRACE 42267 --- [wallet-service] [pool-5-thread-2] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.691+09:00 TRACE 42267 --- [wallet-service] [pool-5-thread-1] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.691+09:00 TRACE 42267 --- [wallet-service] [pool-5-thread-3] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.691+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-2] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(982976082<open>)] for JPA transaction
2024-08-29T21:04:53.692+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-2] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.691+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-1] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(409876686<open>)] for JPA transaction
2024-08-29T21:04:53.692+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-3] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(1518829076<open>)] for JPA transaction
2024-08-29T21:04:53.692+09:00 TRACE 42267 --- [wallet-service] [pool-5-thread-2] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:53.692+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-1] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.692+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-3] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.692+09:00 TRACE 42267 --- [wallet-service] [pool-5-thread-3] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:53.692+09:00 TRACE 42267 --- [wallet-service] [pool-5-thread-1] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:53.692+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-2] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(982976082<open>)] for JPA transaction
2024-08-29T21:04:53.692+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-2] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.692+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-3] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(1518829076<open>)] for JPA transaction
2024-08-29T21:04:53.692+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-1] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(409876686<open>)] for JPA transaction
2024-08-29T21:04:53.692+09:00 TRACE 42267 --- [wallet-service] [pool-5-thread-2] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.692+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-3] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.692+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-1] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.692+09:00 TRACE 42267 --- [wallet-service] [pool-5-thread-3] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.692+09:00 TRACE 42267 --- [wallet-service] [pool-5-thread-1] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
2024-08-29T21:04:53.699+09:00 TRACE 42267 --- [wallet-service] [pool-5-thread-3] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.699+09:00 TRACE 42267 --- [wallet-service] [pool-5-thread-1] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.699+09:00 TRACE 42267 --- [wallet-service] [pool-5-thread-2] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.699+09:00 TRACE 42267 --- [wallet-service] [pool-5-thread-3] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:53.699+09:00 TRACE 42267 --- [wallet-service] [pool-5-thread-2] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:53.699+09:00 TRACE 42267 --- [wallet-service] [pool-5-thread-1] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:53.699+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-2] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction commit
2024-08-29T21:04:53.699+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-1] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction commit
2024-08-29T21:04:53.699+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-2] o.s.orm.jpa.JpaTransactionManager        : Committing JPA transaction on EntityManager [SessionImpl(982976082<open>)]
2024-08-29T21:04:53.699+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-1] o.s.orm.jpa.JpaTransactionManager        : Committing JPA transaction on EntityManager [SessionImpl(409876686<open>)]
2024-08-29T21:04:53.699+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-3] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction commit
2024-08-29T21:04:53.699+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-3] o.s.orm.jpa.JpaTransactionManager        : Committing JPA transaction on EntityManager [SessionImpl(1518829076<open>)]
Hibernate: 
    update
        wallets 
    set
        balance=?,
        user_id=?,
        version=? 
    where
        id=? 
        and version=?
Hibernate: 
    update
        wallets 
    set
        balance=?,
        user_id=?,
        version=? 
    where
        id=? 
        and version=?
Hibernate: 
    update
        wallets 
    set
        balance=?,
        user_id=?,
        version=? 
    where
        id=? 
        and version=?
Hibernate: 
    update
        wallets 
    set
        balance=?,
        user_id=?,
        version=? 
    where
        id=? 
        and version=?
2024-08-29T21:04:53.711+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-1] o.s.orm.jpa.JpaTransactionManager        : Closing JPA EntityManager [SessionImpl(409876686<open>)] after transaction
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
2024-08-29T21:04:53.716+09:00 TRACE 42267 --- [wallet-service] [container-0-C-1] fkaConsumerFactory$ExtendedKafkaConsumer : [Consumer clientId=consumer-wallet-service-2, groupId=wallet-service] Polling for fetches with timeout 1446
2024-08-29T21:04:53.716+09:00 TRACE 42267 --- [wallet-service] [container-0-C-1] fkaConsumerFactory$ExtendedKafkaConsumer : [Consumer clientId=consumer-wallet-service-2, groupId=wallet-service] Polling for fetches with timeout 1445
2024-08-29T21:04:53.717+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-3] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction rollback after commit exception

org.springframework.orm.ObjectOptimisticLockingFailureException: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect) : [org.example.walletservice.wallet.adapter.out.persistence.entity.JpaWalletEntity#40]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:325) ~[spring-orm-6.1.12.jar:6.1.12]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:244) ~[spring-orm-6.1.12.jar:6.1.12]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:566) ~[spring-orm-6.1.12.jar:6.1.12]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:795) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:152) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepository.performSaveOperation(JpaWalletRepository.kt:37) ~[main/:na]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepository.save(JpaWalletRepository.kt:29) ~[main/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:355) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:768) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:768) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:720) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepository$$SpringCGLIB$$0.save(<generated>) ~[main/:na]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepositoryTest.should_update_the_balance_of_wallet_successfully_when_execute_the_updated_command_at_the_same_time$lambda$2(JpaWalletRepositoryTest.kt:89) ~[test/:na]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]
Caused by: org.hibernate.StaleObjectStateException: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect) : [org.example.walletservice.wallet.adapter.out.persistence.entity.JpaWalletEntity#40]
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.identifiedResultsCheck(ModelMutationHelper.java:75) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.lambda$doStaticUpdate$8(UpdateCoordinatorStandard.java:782) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.checkResults(ModelMutationHelper.java:50) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:115) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:40) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:52) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.doStaticUpdate(UpdateCoordinatorStandard.java:778) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.performUpdate(UpdateCoordinatorStandard.java:324) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.coordinateUpdate(UpdateCoordinatorStandard.java:242) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.AbstractEntityPersister.update(AbstractEntityPersister.java:2804) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.action.internal.EntityUpdateAction.execute(EntityUpdateAction.java:168) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:632) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:499) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:377) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:41) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1407) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:488) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2329) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1986) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:562) ~[spring-orm-6.1.12.jar:6.1.12]
	... 24 common frames omitted

2024-08-29T21:04:53.717+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-2] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction rollback after commit exception

org.springframework.orm.ObjectOptimisticLockingFailureException: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect) : [org.example.walletservice.wallet.adapter.out.persistence.entity.JpaWalletEntity#40]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:325) ~[spring-orm-6.1.12.jar:6.1.12]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:244) ~[spring-orm-6.1.12.jar:6.1.12]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:566) ~[spring-orm-6.1.12.jar:6.1.12]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:795) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:152) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepository.performSaveOperation(JpaWalletRepository.kt:37) ~[main/:na]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepository.save(JpaWalletRepository.kt:29) ~[main/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:355) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:768) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:768) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:720) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepository$$SpringCGLIB$$0.save(<generated>) ~[main/:na]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepositoryTest.should_update_the_balance_of_wallet_successfully_when_execute_the_updated_command_at_the_same_time$lambda$1(JpaWalletRepositoryTest.kt:88) ~[test/:na]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]
Caused by: org.hibernate.StaleObjectStateException: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect) : [org.example.walletservice.wallet.adapter.out.persistence.entity.JpaWalletEntity#40]
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.identifiedResultsCheck(ModelMutationHelper.java:75) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.lambda$doStaticUpdate$8(UpdateCoordinatorStandard.java:782) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.checkResults(ModelMutationHelper.java:50) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:115) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:40) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:52) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.doStaticUpdate(UpdateCoordinatorStandard.java:778) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.performUpdate(UpdateCoordinatorStandard.java:324) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.coordinateUpdate(UpdateCoordinatorStandard.java:242) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.AbstractEntityPersister.update(AbstractEntityPersister.java:2804) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.action.internal.EntityUpdateAction.execute(EntityUpdateAction.java:168) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:632) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:499) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:377) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:41) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1407) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:488) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2329) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1986) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:562) ~[spring-orm-6.1.12.jar:6.1.12]
	... 24 common frames omitted

2024-08-29T21:04:53.718+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-3] o.s.orm.jpa.JpaTransactionManager        : Rolling back JPA transaction on EntityManager [SessionImpl(1518829076<open>)]
2024-08-29T21:04:53.718+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-2] o.s.orm.jpa.JpaTransactionManager        : Rolling back JPA transaction on EntityManager [SessionImpl(982976082<open>)]
2024-08-29T21:04:53.719+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-2] o.s.orm.jpa.JpaTransactionManager        : Closing JPA EntityManager [SessionImpl(982976082<open>)] after transaction
2024-08-29T21:04:53.719+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-3] o.s.orm.jpa.JpaTransactionManager        : Closing JPA EntityManager [SessionImpl(1518829076<open>)] after transaction
2024-08-29T21:04:53.719+09:00 TRACE 42267 --- [wallet-service] [pool-5-thread-3] o.s.t.i.TransactionInterceptor           : No need to create transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.findByIdIn]: This method is not transactional.
2024-08-29T21:04:53.719+09:00 TRACE 42267 --- [wallet-service] [pool-5-thread-2] o.s.t.i.TransactionInterceptor           : No need to create transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.findByIdIn]: This method is not transactional.
2024-08-29T21:04:53.719+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-3] tor$SharedEntityManagerInvocationHandler : Creating new EntityManager for shared EntityManager invocation
2024-08-29T21:04:53.719+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-2] tor$SharedEntityManagerInvocationHandler : Creating new EntityManager for shared EntityManager invocation
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id in (?, ?)
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id in (?, ?)
2024-08-29T21:04:53.722+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-2] o.s.orm.jpa.JpaTransactionManager        : Creating new transaction with name [null]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT
2024-08-29T21:04:53.722+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-3] o.s.orm.jpa.JpaTransactionManager        : Creating new transaction with name [null]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT
2024-08-29T21:04:53.722+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-2] o.s.orm.jpa.JpaTransactionManager        : Opened new EntityManager [SessionImpl(2009594846<open>)] for JPA transaction
2024-08-29T21:04:53.722+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-3] o.s.orm.jpa.JpaTransactionManager        : Opened new EntityManager [SessionImpl(1985062955<open>)] for JPA transaction
2024-08-29T21:04:53.724+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-3] o.s.orm.jpa.JpaTransactionManager        : Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@2653bdbb]
2024-08-29T21:04:53.724+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-2] o.s.orm.jpa.JpaTransactionManager        : Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@7a7b2bc2]
2024-08-29T21:04:53.724+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-3] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(1985062955<open>)] for JPA transaction
2024-08-29T21:04:53.724+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-2] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(2009594846<open>)] for JPA transaction
2024-08-29T21:04:53.724+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-3] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.724+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-2] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.724+09:00 TRACE 42267 --- [wallet-service] [pool-5-thread-2] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.724+09:00 TRACE 42267 --- [wallet-service] [pool-5-thread-3] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
2024-08-29T21:04:53.728+09:00 TRACE 42267 --- [wallet-service] [pool-5-thread-2] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.728+09:00 TRACE 42267 --- [wallet-service] [pool-5-thread-3] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.728+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-2] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(2009594846<open>)] for JPA transaction
2024-08-29T21:04:53.728+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-2] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.728+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-3] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(1985062955<open>)] for JPA transaction
2024-08-29T21:04:53.728+09:00 TRACE 42267 --- [wallet-service] [pool-5-thread-2] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:53.728+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-3] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.729+09:00 TRACE 42267 --- [wallet-service] [pool-5-thread-3] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:53.729+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-2] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(2009594846<open>)] for JPA transaction
2024-08-29T21:04:53.729+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-2] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.729+09:00 TRACE 42267 --- [wallet-service] [pool-5-thread-2] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.729+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-3] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(1985062955<open>)] for JPA transaction
2024-08-29T21:04:53.729+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-3] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.729+09:00 TRACE 42267 --- [wallet-service] [pool-5-thread-3] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
2024-08-29T21:04:53.734+09:00 TRACE 42267 --- [wallet-service] [pool-5-thread-2] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.734+09:00 TRACE 42267 --- [wallet-service] [pool-5-thread-3] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.734+09:00 TRACE 42267 --- [wallet-service] [pool-5-thread-2] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:53.734+09:00 TRACE 42267 --- [wallet-service] [pool-5-thread-3] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:53.734+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-2] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction commit
2024-08-29T21:04:53.734+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-3] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction commit
2024-08-29T21:04:53.734+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-2] o.s.orm.jpa.JpaTransactionManager        : Committing JPA transaction on EntityManager [SessionImpl(2009594846<open>)]
2024-08-29T21:04:53.734+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-3] o.s.orm.jpa.JpaTransactionManager        : Committing JPA transaction on EntityManager [SessionImpl(1985062955<open>)]
Hibernate: 
    update
        wallets 
    set
        balance=?,
        user_id=?,
        version=? 
    where
        id=? 
        and version=?
Hibernate: 
    update
        wallets 
    set
        balance=?,
        user_id=?,
        version=? 
    where
        id=? 
        and version=?
Hibernate: 
    update
        wallets 
    set
        balance=?,
        user_id=?,
        version=? 
    where
        id=? 
        and version=?
2024-08-29T21:04:53.743+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-3] o.s.orm.jpa.JpaTransactionManager        : Closing JPA EntityManager [SessionImpl(1985062955<open>)] after transaction
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
2024-08-29T21:04:53.746+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-2] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction rollback after commit exception

org.springframework.orm.ObjectOptimisticLockingFailureException: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect) : [org.example.walletservice.wallet.adapter.out.persistence.entity.JpaWalletEntity#40]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:325) ~[spring-orm-6.1.12.jar:6.1.12]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:244) ~[spring-orm-6.1.12.jar:6.1.12]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:566) ~[spring-orm-6.1.12.jar:6.1.12]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:795) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:152) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepository.performSaveOperationWithRecent(JpaWalletRepository.kt:69) ~[main/:na]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepository.retrySaveOperation(JpaWalletRepository.kt:48) ~[main/:na]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepository.retrySaveOperation$default(JpaWalletRepository.kt:43) ~[main/:na]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepository.save(JpaWalletRepository.kt:31) ~[main/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:355) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:768) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:768) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:720) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepository$$SpringCGLIB$$0.save(<generated>) ~[main/:na]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepositoryTest.should_update_the_balance_of_wallet_successfully_when_execute_the_updated_command_at_the_same_time$lambda$1(JpaWalletRepositoryTest.kt:88) ~[test/:na]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]
Caused by: org.hibernate.StaleObjectStateException: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect) : [org.example.walletservice.wallet.adapter.out.persistence.entity.JpaWalletEntity#40]
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.identifiedResultsCheck(ModelMutationHelper.java:75) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.lambda$doStaticUpdate$8(UpdateCoordinatorStandard.java:782) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.checkResults(ModelMutationHelper.java:50) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:115) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:40) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:52) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.doStaticUpdate(UpdateCoordinatorStandard.java:778) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.performUpdate(UpdateCoordinatorStandard.java:324) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.coordinateUpdate(UpdateCoordinatorStandard.java:242) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.AbstractEntityPersister.update(AbstractEntityPersister.java:2804) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.action.internal.EntityUpdateAction.execute(EntityUpdateAction.java:168) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:632) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:499) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:377) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:41) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1407) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:488) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2329) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1986) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:562) ~[spring-orm-6.1.12.jar:6.1.12]
	... 26 common frames omitted

2024-08-29T21:04:53.747+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-2] o.s.orm.jpa.JpaTransactionManager        : Rolling back JPA transaction on EntityManager [SessionImpl(2009594846<open>)]
2024-08-29T21:04:53.747+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-2] o.s.orm.jpa.JpaTransactionManager        : Closing JPA EntityManager [SessionImpl(2009594846<open>)] after transaction
2024-08-29T21:04:53.754+09:00 TRACE 42267 --- [wallet-service] [pool-5-thread-2] o.s.t.i.TransactionInterceptor           : No need to create transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.findByIdIn]: This method is not transactional.
2024-08-29T21:04:53.755+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-2] tor$SharedEntityManagerInvocationHandler : Creating new EntityManager for shared EntityManager invocation
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id in (?, ?)
2024-08-29T21:04:53.757+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-2] o.s.orm.jpa.JpaTransactionManager        : Creating new transaction with name [null]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT
2024-08-29T21:04:53.758+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-2] o.s.orm.jpa.JpaTransactionManager        : Opened new EntityManager [SessionImpl(865857201<open>)] for JPA transaction
2024-08-29T21:04:53.758+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-2] o.s.orm.jpa.JpaTransactionManager        : Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@2d1d2417]
2024-08-29T21:04:53.758+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-2] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(865857201<open>)] for JPA transaction
2024-08-29T21:04:53.758+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-2] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.758+09:00 TRACE 42267 --- [wallet-service] [pool-5-thread-2] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
2024-08-29T21:04:53.762+09:00 TRACE 42267 --- [wallet-service] [pool-5-thread-2] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.762+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-2] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(865857201<open>)] for JPA transaction
2024-08-29T21:04:53.762+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-2] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.762+09:00 TRACE 42267 --- [wallet-service] [pool-5-thread-2] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:53.762+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-2] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(865857201<open>)] for JPA transaction
2024-08-29T21:04:53.762+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-2] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.762+09:00 TRACE 42267 --- [wallet-service] [pool-5-thread-2] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
2024-08-29T21:04:53.766+09:00 TRACE 42267 --- [wallet-service] [pool-5-thread-2] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.766+09:00 TRACE 42267 --- [wallet-service] [pool-5-thread-2] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:53.766+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-2] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction commit
2024-08-29T21:04:53.766+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-2] o.s.orm.jpa.JpaTransactionManager        : Committing JPA transaction on EntityManager [SessionImpl(865857201<open>)]
Hibernate: 
    update
        wallets 
    set
        balance=?,
        user_id=?,
        version=? 
    where
        id=? 
        and version=?
Hibernate: 
    update
        wallets 
    set
        balance=?,
        user_id=?,
        version=? 
    where
        id=? 
        and version=?
2024-08-29T21:04:53.772+09:00 DEBUG 42267 --- [wallet-service] [pool-5-thread-2] o.s.orm.jpa.JpaTransactionManager        : Closing JPA EntityManager [SessionImpl(865857201<open>)] after transaction
2024-08-29T21:04:53.772+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Creating new transaction with name [org.springframework.data.jpa.repository.support.SimpleJpaRepository.findById]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT,readOnly
2024-08-29T21:04:53.772+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Opened new EntityManager [SessionImpl(803793969<open>)] for JPA transaction
2024-08-29T21:04:53.774+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@46bcdf2e]
2024-08-29T21:04:53.774+09:00 TRACE 42267 --- [wallet-service] [    Test worker] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.findById]
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
2024-08-29T21:04:53.775+09:00 TRACE 42267 --- [wallet-service] [    Test worker] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.findById]
2024-08-29T21:04:53.775+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction commit
2024-08-29T21:04:53.775+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Committing JPA transaction on EntityManager [SessionImpl(803793969<open>)]
2024-08-29T21:04:53.777+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Closing JPA EntityManager [SessionImpl(803793969<open>)] after transaction
2024-08-29T21:04:53.777+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Creating new transaction with name [org.springframework.data.jpa.repository.support.SimpleJpaRepository.findById]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT,readOnly
2024-08-29T21:04:53.777+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Opened new EntityManager [SessionImpl(1624044696<open>)] for JPA transaction
2024-08-29T21:04:53.778+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@430ec0d7]
2024-08-29T21:04:53.778+09:00 TRACE 42267 --- [wallet-service] [    Test worker] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.findById]
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
2024-08-29T21:04:53.780+09:00 TRACE 42267 --- [wallet-service] [    Test worker] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.findById]
2024-08-29T21:04:53.780+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction commit
2024-08-29T21:04:53.780+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Committing JPA transaction on EntityManager [SessionImpl(1624044696<open>)]
2024-08-29T21:04:53.782+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Closing JPA EntityManager [SessionImpl(1624044696<open>)] after transaction
2024-08-29T21:04:53.787+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Creating new transaction with name [org.springframework.data.jpa.repository.support.SimpleJpaRepository.deleteAll]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT
2024-08-29T21:04:53.787+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Opened new EntityManager [SessionImpl(995269027<open>)] for JPA transaction
2024-08-29T21:04:53.788+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@393d1a05]
2024-08-29T21:04:53.789+09:00 TRACE 42267 --- [wallet-service] [    Test worker] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.deleteAll]
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0
2024-08-29T21:04:53.792+09:00 TRACE 42267 --- [wallet-service] [    Test worker] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.deleteAll]
2024-08-29T21:04:53.792+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction commit
2024-08-29T21:04:53.792+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Committing JPA transaction on EntityManager [SessionImpl(995269027<open>)]
Hibernate: 
    delete 
    from
        wallets 
    where
        id=? 
        and version=?
Hibernate: 
    delete 
    from
        wallets 
    where
        id=? 
        and version=?
2024-08-29T21:04:53.798+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Closing JPA EntityManager [SessionImpl(995269027<open>)] after transaction
2024-08-29T21:04:53.798+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Creating new transaction with name [org.springframework.data.jpa.repository.support.SimpleJpaRepository.deleteAll]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT
2024-08-29T21:04:53.798+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Opened new EntityManager [SessionImpl(865600325<open>)] for JPA transaction
2024-08-29T21:04:53.799+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@195c5803]
2024-08-29T21:04:53.799+09:00 TRACE 42267 --- [wallet-service] [    Test worker] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.deleteAll]
Hibernate: 
    select
        jwte1_0.id,
        jwte1_0.amount,
        jwte1_0.idempotency_key,
        jwte1_0.order_id,
        jwte1_0.reference_id,
        jwte1_0.reference_type,
        jwte1_0.type,
        jwte1_0.wallet_id 
    from
        wallet_transactions jwte1_0
2024-08-29T21:04:53.803+09:00 TRACE 42267 --- [wallet-service] [    Test worker] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.deleteAll]
2024-08-29T21:04:53.803+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction commit
2024-08-29T21:04:53.803+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Committing JPA transaction on EntityManager [SessionImpl(865600325<open>)]
Hibernate: 
    delete 
    from
        wallet_transactions 
    where
        id=?
Hibernate: 
    delete 
    from
        wallet_transactions 
    where
        id=?
Hibernate: 
    delete 
    from
        wallet_transactions 
    where
        id=?
Hibernate: 
    delete 
    from
        wallet_transactions 
    where
        id=?
Hibernate: 
    delete 
    from
        wallet_transactions 
    where
        id=?
Hibernate: 
    delete 
    from
        wallet_transactions 
    where
        id=?
2024-08-29T21:04:53.815+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Closing JPA EntityManager [SessionImpl(865600325<open>)] after transaction
2024-08-29T21:04:53.815+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Creating new transaction with name [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT
2024-08-29T21:04:53.815+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Opened new EntityManager [SessionImpl(656400047<open>)] for JPA transaction
2024-08-29T21:04:53.816+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@55bd9d1]
2024-08-29T21:04:53.816+09:00 TRACE 42267 --- [wallet-service] [    Test worker] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
Hibernate: 
    insert 
    into
        wallets
        (balance, user_id, version) 
    values
        (?, ?, ?)
Hibernate: 
    insert 
    into
        wallets
        (balance, user_id, version) 
    values
        (?, ?, ?)
2024-08-29T21:04:53.820+09:00 TRACE 42267 --- [wallet-service] [    Test worker] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.820+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction commit
2024-08-29T21:04:53.820+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Committing JPA transaction on EntityManager [SessionImpl(656400047<open>)]
2024-08-29T21:04:53.824+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Closing JPA EntityManager [SessionImpl(656400047<open>)] after transaction
2024-08-29T21:04:53.824+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-1] o.s.orm.jpa.JpaTransactionManager        : Creating new transaction with name [null]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT
2024-08-29T21:04:53.824+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-2] o.s.orm.jpa.JpaTransactionManager        : Creating new transaction with name [null]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT
2024-08-29T21:04:53.825+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-1] o.s.orm.jpa.JpaTransactionManager        : Opened new EntityManager [SessionImpl(1868605324<open>)] for JPA transaction
2024-08-29T21:04:53.825+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-3] o.s.orm.jpa.JpaTransactionManager        : Creating new transaction with name [null]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT
2024-08-29T21:04:53.825+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-2] o.s.orm.jpa.JpaTransactionManager        : Opened new EntityManager [SessionImpl(811717321<open>)] for JPA transaction
2024-08-29T21:04:53.825+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-3] o.s.orm.jpa.JpaTransactionManager        : Opened new EntityManager [SessionImpl(2051265869<open>)] for JPA transaction
2024-08-29T21:04:53.826+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-2] o.s.orm.jpa.JpaTransactionManager        : Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@3ea63ab5]
2024-08-29T21:04:53.826+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-3] o.s.orm.jpa.JpaTransactionManager        : Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@74842475]
2024-08-29T21:04:53.826+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-1] o.s.orm.jpa.JpaTransactionManager        : Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@61a74410]
2024-08-29T21:04:53.826+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-2] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(811717321<open>)] for JPA transaction
2024-08-29T21:04:53.826+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-1] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(1868605324<open>)] for JPA transaction
2024-08-29T21:04:53.826+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-2] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.826+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-1] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.826+09:00 TRACE 42267 --- [wallet-service] [pool-6-thread-2] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.826+09:00 TRACE 42267 --- [wallet-service] [pool-6-thread-1] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.826+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-3] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(2051265869<open>)] for JPA transaction
2024-08-29T21:04:53.826+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-3] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.826+09:00 TRACE 42267 --- [wallet-service] [pool-6-thread-3] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
2024-08-29T21:04:53.831+09:00 TRACE 42267 --- [wallet-service] [pool-6-thread-2] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.831+09:00 TRACE 42267 --- [wallet-service] [pool-6-thread-3] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.831+09:00 TRACE 42267 --- [wallet-service] [pool-6-thread-1] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.831+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-2] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(811717321<open>)] for JPA transaction
2024-08-29T21:04:53.831+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-3] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(2051265869<open>)] for JPA transaction
2024-08-29T21:04:53.831+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-2] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.831+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-1] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(1868605324<open>)] for JPA transaction
2024-08-29T21:04:53.831+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-3] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.831+09:00 TRACE 42267 --- [wallet-service] [pool-6-thread-2] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:53.831+09:00 TRACE 42267 --- [wallet-service] [pool-6-thread-3] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:53.831+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-1] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.831+09:00 TRACE 42267 --- [wallet-service] [pool-6-thread-1] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:53.831+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-2] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(811717321<open>)] for JPA transaction
2024-08-29T21:04:53.831+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-2] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.831+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-3] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(2051265869<open>)] for JPA transaction
2024-08-29T21:04:53.831+09:00 TRACE 42267 --- [wallet-service] [pool-6-thread-2] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.831+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-3] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.831+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-1] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(1868605324<open>)] for JPA transaction
2024-08-29T21:04:53.831+09:00 TRACE 42267 --- [wallet-service] [pool-6-thread-3] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.832+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-1] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.832+09:00 TRACE 42267 --- [wallet-service] [pool-6-thread-1] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
2024-08-29T21:04:53.837+09:00 TRACE 42267 --- [wallet-service] [pool-6-thread-1] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.837+09:00 TRACE 42267 --- [wallet-service] [pool-6-thread-3] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.837+09:00 TRACE 42267 --- [wallet-service] [pool-6-thread-1] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:53.837+09:00 TRACE 42267 --- [wallet-service] [pool-6-thread-2] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.838+09:00 TRACE 42267 --- [wallet-service] [pool-6-thread-3] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:53.838+09:00 TRACE 42267 --- [wallet-service] [pool-6-thread-2] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:53.838+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-1] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction commit
2024-08-29T21:04:53.838+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-2] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction commit
2024-08-29T21:04:53.838+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-1] o.s.orm.jpa.JpaTransactionManager        : Committing JPA transaction on EntityManager [SessionImpl(1868605324<open>)]
2024-08-29T21:04:53.838+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-3] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction commit
2024-08-29T21:04:53.838+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-2] o.s.orm.jpa.JpaTransactionManager        : Committing JPA transaction on EntityManager [SessionImpl(811717321<open>)]
2024-08-29T21:04:53.838+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-3] o.s.orm.jpa.JpaTransactionManager        : Committing JPA transaction on EntityManager [SessionImpl(2051265869<open>)]
Hibernate: 
    update
        wallets 
    set
        balance=?,
        user_id=?,
        version=? 
    where
        id=? 
        and version=?
Hibernate: 
    update
        wallets 
    set
        balance=?,
        user_id=?,
        version=? 
    where
        id=? 
        and version=?
Hibernate: 
    update
        wallets 
    set
        balance=?,
        user_id=?,
        version=? 
    where
        id=? 
        and version=?
Hibernate: 
    update
        wallets 
    set
        balance=?,
        user_id=?,
        version=? 
    where
        id=? 
        and version=?
2024-08-29T21:04:53.846+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-2] o.s.orm.jpa.JpaTransactionManager        : Closing JPA EntityManager [SessionImpl(811717321<open>)] after transaction
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
2024-08-29T21:04:53.851+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-3] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction rollback after commit exception

org.springframework.orm.ObjectOptimisticLockingFailureException: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect) : [org.example.walletservice.wallet.adapter.out.persistence.entity.JpaWalletEntity#42]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:325) ~[spring-orm-6.1.12.jar:6.1.12]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:244) ~[spring-orm-6.1.12.jar:6.1.12]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:566) ~[spring-orm-6.1.12.jar:6.1.12]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:795) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:152) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepository.performSaveOperation(JpaWalletRepository.kt:37) ~[main/:na]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepository.save(JpaWalletRepository.kt:29) ~[main/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:355) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:768) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:768) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:720) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepository$$SpringCGLIB$$0.save(<generated>) ~[main/:na]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepositoryTest.should_update_the_balance_of_wallet_successfully_when_execute_the_updated_command_at_the_same_time$lambda$2(JpaWalletRepositoryTest.kt:89) ~[test/:na]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]
Caused by: org.hibernate.StaleObjectStateException: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect) : [org.example.walletservice.wallet.adapter.out.persistence.entity.JpaWalletEntity#42]
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.identifiedResultsCheck(ModelMutationHelper.java:75) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.lambda$doStaticUpdate$8(UpdateCoordinatorStandard.java:782) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.checkResults(ModelMutationHelper.java:50) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:115) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:40) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:52) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.doStaticUpdate(UpdateCoordinatorStandard.java:778) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.performUpdate(UpdateCoordinatorStandard.java:324) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.coordinateUpdate(UpdateCoordinatorStandard.java:242) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.AbstractEntityPersister.update(AbstractEntityPersister.java:2804) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.action.internal.EntityUpdateAction.execute(EntityUpdateAction.java:168) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:632) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:499) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:377) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:41) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1407) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:488) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2329) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1986) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:562) ~[spring-orm-6.1.12.jar:6.1.12]
	... 24 common frames omitted

2024-08-29T21:04:53.852+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-3] o.s.orm.jpa.JpaTransactionManager        : Rolling back JPA transaction on EntityManager [SessionImpl(2051265869<open>)]
2024-08-29T21:04:53.852+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-3] o.s.orm.jpa.JpaTransactionManager        : Closing JPA EntityManager [SessionImpl(2051265869<open>)] after transaction
2024-08-29T21:04:53.852+09:00 TRACE 42267 --- [wallet-service] [pool-6-thread-3] o.s.t.i.TransactionInterceptor           : No need to create transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.findByIdIn]: This method is not transactional.
2024-08-29T21:04:53.852+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-3] tor$SharedEntityManagerInvocationHandler : Creating new EntityManager for shared EntityManager invocation
2024-08-29T21:04:53.852+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-1] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction rollback after commit exception

org.springframework.orm.ObjectOptimisticLockingFailureException: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect) : [org.example.walletservice.wallet.adapter.out.persistence.entity.JpaWalletEntity#42]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:325) ~[spring-orm-6.1.12.jar:6.1.12]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:244) ~[spring-orm-6.1.12.jar:6.1.12]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:566) ~[spring-orm-6.1.12.jar:6.1.12]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:795) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:152) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepository.performSaveOperation(JpaWalletRepository.kt:37) ~[main/:na]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepository.save(JpaWalletRepository.kt:29) ~[main/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:355) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:768) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:768) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:720) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepository$$SpringCGLIB$$0.save(<generated>) ~[main/:na]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepositoryTest.should_update_the_balance_of_wallet_successfully_when_execute_the_updated_command_at_the_same_time$lambda$0(JpaWalletRepositoryTest.kt:87) ~[test/:na]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]
Caused by: org.hibernate.StaleObjectStateException: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect) : [org.example.walletservice.wallet.adapter.out.persistence.entity.JpaWalletEntity#42]
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.identifiedResultsCheck(ModelMutationHelper.java:75) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.lambda$doStaticUpdate$8(UpdateCoordinatorStandard.java:782) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.checkResults(ModelMutationHelper.java:50) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:115) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:40) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:52) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.doStaticUpdate(UpdateCoordinatorStandard.java:778) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.performUpdate(UpdateCoordinatorStandard.java:324) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.coordinateUpdate(UpdateCoordinatorStandard.java:242) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.AbstractEntityPersister.update(AbstractEntityPersister.java:2804) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.action.internal.EntityUpdateAction.execute(EntityUpdateAction.java:168) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:632) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:499) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:377) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:41) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1407) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:488) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2329) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1986) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:562) ~[spring-orm-6.1.12.jar:6.1.12]
	... 24 common frames omitted

2024-08-29T21:04:53.853+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-1] o.s.orm.jpa.JpaTransactionManager        : Rolling back JPA transaction on EntityManager [SessionImpl(1868605324<open>)]
2024-08-29T21:04:53.853+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-1] o.s.orm.jpa.JpaTransactionManager        : Closing JPA EntityManager [SessionImpl(1868605324<open>)] after transaction
2024-08-29T21:04:53.854+09:00 TRACE 42267 --- [wallet-service] [pool-6-thread-1] o.s.t.i.TransactionInterceptor           : No need to create transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.findByIdIn]: This method is not transactional.
2024-08-29T21:04:53.854+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-1] tor$SharedEntityManagerInvocationHandler : Creating new EntityManager for shared EntityManager invocation
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id in (?, ?)
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id in (?, ?)
2024-08-29T21:04:53.856+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-3] o.s.orm.jpa.JpaTransactionManager        : Creating new transaction with name [null]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT
2024-08-29T21:04:53.856+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-3] o.s.orm.jpa.JpaTransactionManager        : Opened new EntityManager [SessionImpl(1461110749<open>)] for JPA transaction
2024-08-29T21:04:53.857+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-1] o.s.orm.jpa.JpaTransactionManager        : Creating new transaction with name [null]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT
2024-08-29T21:04:53.857+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-1] o.s.orm.jpa.JpaTransactionManager        : Opened new EntityManager [SessionImpl(238444706<open>)] for JPA transaction
2024-08-29T21:04:53.857+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-3] o.s.orm.jpa.JpaTransactionManager        : Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@9e7f890]
2024-08-29T21:04:53.857+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-3] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(1461110749<open>)] for JPA transaction
2024-08-29T21:04:53.857+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-3] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.857+09:00 TRACE 42267 --- [wallet-service] [pool-6-thread-3] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
2024-08-29T21:04:53.858+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-1] o.s.orm.jpa.JpaTransactionManager        : Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@47ced56]
2024-08-29T21:04:53.858+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-1] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(238444706<open>)] for JPA transaction
2024-08-29T21:04:53.858+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-1] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.858+09:00 TRACE 42267 --- [wallet-service] [pool-6-thread-1] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
2024-08-29T21:04:53.861+09:00 TRACE 42267 --- [wallet-service] [pool-6-thread-3] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.861+09:00 TRACE 42267 --- [wallet-service] [pool-6-thread-1] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.861+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-3] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(1461110749<open>)] for JPA transaction
2024-08-29T21:04:53.861+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-1] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(238444706<open>)] for JPA transaction
2024-08-29T21:04:53.861+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-3] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.862+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-1] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.862+09:00 TRACE 42267 --- [wallet-service] [pool-6-thread-3] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:53.862+09:00 TRACE 42267 --- [wallet-service] [pool-6-thread-1] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:53.862+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-1] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(238444706<open>)] for JPA transaction
2024-08-29T21:04:53.862+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-3] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(1461110749<open>)] for JPA transaction
2024-08-29T21:04:53.862+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-1] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.862+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-3] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.862+09:00 TRACE 42267 --- [wallet-service] [pool-6-thread-1] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.862+09:00 TRACE 42267 --- [wallet-service] [pool-6-thread-3] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
2024-08-29T21:04:53.867+09:00 TRACE 42267 --- [wallet-service] [pool-6-thread-1] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.867+09:00 TRACE 42267 --- [wallet-service] [pool-6-thread-3] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.867+09:00 TRACE 42267 --- [wallet-service] [pool-6-thread-1] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:53.867+09:00 TRACE 42267 --- [wallet-service] [pool-6-thread-3] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:53.867+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-1] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction commit
2024-08-29T21:04:53.867+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-3] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction commit
2024-08-29T21:04:53.868+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-1] o.s.orm.jpa.JpaTransactionManager        : Committing JPA transaction on EntityManager [SessionImpl(238444706<open>)]
2024-08-29T21:04:53.868+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-3] o.s.orm.jpa.JpaTransactionManager        : Committing JPA transaction on EntityManager [SessionImpl(1461110749<open>)]
Hibernate: 
    update
        wallets 
    set
        balance=?,
        user_id=?,
        version=? 
    where
        id=? 
        and version=?
Hibernate: 
    update
        wallets 
    set
        balance=?,
        user_id=?,
        version=? 
    where
        id=? 
        and version=?
Hibernate: 
    update
        wallets 
    set
        balance=?,
        user_id=?,
        version=? 
    where
        id=? 
        and version=?
2024-08-29T21:04:53.876+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-3] o.s.orm.jpa.JpaTransactionManager        : Closing JPA EntityManager [SessionImpl(1461110749<open>)] after transaction
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
2024-08-29T21:04:53.880+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-1] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction rollback after commit exception

org.springframework.orm.ObjectOptimisticLockingFailureException: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect) : [org.example.walletservice.wallet.adapter.out.persistence.entity.JpaWalletEntity#42]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:325) ~[spring-orm-6.1.12.jar:6.1.12]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:244) ~[spring-orm-6.1.12.jar:6.1.12]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:566) ~[spring-orm-6.1.12.jar:6.1.12]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:795) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:152) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepository.performSaveOperationWithRecent(JpaWalletRepository.kt:69) ~[main/:na]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepository.retrySaveOperation(JpaWalletRepository.kt:48) ~[main/:na]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepository.retrySaveOperation$default(JpaWalletRepository.kt:43) ~[main/:na]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepository.save(JpaWalletRepository.kt:31) ~[main/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:355) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:768) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:768) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:720) ~[spring-aop-6.1.12.jar:6.1.12]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepository$$SpringCGLIB$$0.save(<generated>) ~[main/:na]
	at org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletRepositoryTest.should_update_the_balance_of_wallet_successfully_when_execute_the_updated_command_at_the_same_time$lambda$0(JpaWalletRepositoryTest.kt:87) ~[test/:na]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]
Caused by: org.hibernate.StaleObjectStateException: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect) : [org.example.walletservice.wallet.adapter.out.persistence.entity.JpaWalletEntity#42]
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.identifiedResultsCheck(ModelMutationHelper.java:75) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.lambda$doStaticUpdate$8(UpdateCoordinatorStandard.java:782) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.checkResults(ModelMutationHelper.java:50) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:115) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:40) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:52) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.doStaticUpdate(UpdateCoordinatorStandard.java:778) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.performUpdate(UpdateCoordinatorStandard.java:324) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.coordinateUpdate(UpdateCoordinatorStandard.java:242) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.persister.entity.AbstractEntityPersister.update(AbstractEntityPersister.java:2804) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.action.internal.EntityUpdateAction.execute(EntityUpdateAction.java:168) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:632) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:499) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:377) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:41) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1407) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:488) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2329) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1986) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101) ~[hibernate-core-6.4.10.Final.jar:6.4.10.Final]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:562) ~[spring-orm-6.1.12.jar:6.1.12]
	... 26 common frames omitted

2024-08-29T21:04:53.881+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-1] o.s.orm.jpa.JpaTransactionManager        : Rolling back JPA transaction on EntityManager [SessionImpl(238444706<open>)]
2024-08-29T21:04:53.881+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-1] o.s.orm.jpa.JpaTransactionManager        : Closing JPA EntityManager [SessionImpl(238444706<open>)] after transaction
2024-08-29T21:04:53.973+09:00 TRACE 42267 --- [wallet-service] [pool-6-thread-1] o.s.t.i.TransactionInterceptor           : No need to create transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.findByIdIn]: This method is not transactional.
2024-08-29T21:04:53.974+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-1] tor$SharedEntityManagerInvocationHandler : Creating new EntityManager for shared EntityManager invocation
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id in (?, ?)
2024-08-29T21:04:53.976+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-1] o.s.orm.jpa.JpaTransactionManager        : Creating new transaction with name [null]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT
2024-08-29T21:04:53.976+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-1] o.s.orm.jpa.JpaTransactionManager        : Opened new EntityManager [SessionImpl(2028143301<open>)] for JPA transaction
2024-08-29T21:04:53.977+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-1] o.s.orm.jpa.JpaTransactionManager        : Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@6699648]
2024-08-29T21:04:53.977+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-1] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(2028143301<open>)] for JPA transaction
2024-08-29T21:04:53.977+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-1] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.977+09:00 TRACE 42267 --- [wallet-service] [pool-6-thread-1] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
2024-08-29T21:04:53.980+09:00 TRACE 42267 --- [wallet-service] [pool-6-thread-1] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.980+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-1] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(2028143301<open>)] for JPA transaction
2024-08-29T21:04:53.980+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-1] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.980+09:00 TRACE 42267 --- [wallet-service] [pool-6-thread-1] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:53.981+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-1] o.s.orm.jpa.JpaTransactionManager        : Found thread-bound EntityManager [SessionImpl(2028143301<open>)] for JPA transaction
2024-08-29T21:04:53.981+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-1] o.s.orm.jpa.JpaTransactionManager        : Participating in existing transaction
2024-08-29T21:04:53.981+09:00 TRACE 42267 --- [wallet-service] [pool-6-thread-1] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
Hibernate: 
    insert 
    into
        wallet_transactions
        (amount, idempotency_key, order_id, reference_id, reference_type, type, wallet_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
2024-08-29T21:04:53.984+09:00 TRACE 42267 --- [wallet-service] [pool-6-thread-1] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.saveAll]
2024-08-29T21:04:53.984+09:00 TRACE 42267 --- [wallet-service] [pool-6-thread-1] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.example.walletservice.wallet.adapter.out.persistence.repsitory.JpaWalletTransactionRepository.save]
2024-08-29T21:04:53.984+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-1] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction commit
2024-08-29T21:04:53.984+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-1] o.s.orm.jpa.JpaTransactionManager        : Committing JPA transaction on EntityManager [SessionImpl(2028143301<open>)]
Hibernate: 
    update
        wallets 
    set
        balance=?,
        user_id=?,
        version=? 
    where
        id=? 
        and version=?
Hibernate: 
    update
        wallets 
    set
        balance=?,
        user_id=?,
        version=? 
    where
        id=? 
        and version=?
2024-08-29T21:04:53.991+09:00 DEBUG 42267 --- [wallet-service] [pool-6-thread-1] o.s.orm.jpa.JpaTransactionManager        : Closing JPA EntityManager [SessionImpl(2028143301<open>)] after transaction
2024-08-29T21:04:53.991+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Creating new transaction with name [org.springframework.data.jpa.repository.support.SimpleJpaRepository.findById]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT,readOnly
2024-08-29T21:04:53.991+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Opened new EntityManager [SessionImpl(435964064<open>)] for JPA transaction
2024-08-29T21:04:53.992+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@3edea9e6]
2024-08-29T21:04:53.992+09:00 TRACE 42267 --- [wallet-service] [    Test worker] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.findById]
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
2024-08-29T21:04:53.993+09:00 TRACE 42267 --- [wallet-service] [    Test worker] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.findById]
2024-08-29T21:04:53.994+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction commit
2024-08-29T21:04:53.994+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Committing JPA transaction on EntityManager [SessionImpl(435964064<open>)]
2024-08-29T21:04:53.995+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Closing JPA EntityManager [SessionImpl(435964064<open>)] after transaction
2024-08-29T21:04:53.995+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Creating new transaction with name [org.springframework.data.jpa.repository.support.SimpleJpaRepository.findById]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT,readOnly
2024-08-29T21:04:53.995+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Opened new EntityManager [SessionImpl(1878099363<open>)] for JPA transaction
2024-08-29T21:04:53.996+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Exposing JPA transaction as JDBC [org.springframework.orm.jpa.vendor.HibernateJpaDialect$HibernateConnectionHandle@320d98f5]
2024-08-29T21:04:53.996+09:00 TRACE 42267 --- [wallet-service] [    Test worker] o.s.t.i.TransactionInterceptor           : Getting transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.findById]
Hibernate: 
    select
        jwe1_0.id,
        jwe1_0.balance,
        jwe1_0.user_id,
        jwe1_0.version 
    from
        wallets jwe1_0 
    where
        jwe1_0.id=?
2024-08-29T21:04:53.998+09:00 TRACE 42267 --- [wallet-service] [    Test worker] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.findById]
2024-08-29T21:04:53.998+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction commit
2024-08-29T21:04:53.998+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Committing JPA transaction on EntityManager [SessionImpl(1878099363<open>)]
2024-08-29T21:04:54.000+09:00 DEBUG 42267 --- [wallet-service] [    Test worker] o.s.orm.jpa.JpaTransactionManager        : Closing JPA EntityManager [SessionImpl(1878099363<open>)] after transaction
]]></system-out>
  <system-err><![CDATA[]]></system-err>
</testsuite>
